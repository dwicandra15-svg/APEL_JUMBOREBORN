<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APEL JUMBO Reborn- Aplikasi Elektronik Jurnal Mengajar Berbasis Online</title>
<meta name="description" content="Aplikasi Elektronik Jurnal Mengajar Berbasis Online berbasis web untuk manajemen kelas, absensi, nilai, jurnal mengajar, dan pembayaran UMMI.">

<!-- Open Graph / WhatsApp / Telegram link preview -->
<meta property="og:type" content="website">
<meta property="og:title" content="APEL JUMBO Reborn">
<meta property="og:description" content="Aplikasi Elektronik Jurnal Mengajar Berbasis Online - Manajemen kelas, absensi, nilai & jurnal mengajar">
<meta property="og:site_name" content="APEL JUMBO Reborn">
<meta property="og:image" content="https://dwicandra15-svg.github.io/APEL_JUMBOREBORN/apel-thumbnail.png">
<meta property="og:url" content="https://dwicandra15-svg.github.io/APEL_JUMBOREBORN/">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="APEL JUMBO Reborn">
<meta name="twitter:description" content="Aplikasi Elektronik Jurnal Mengajar Berbasis Online">
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Sora:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
:root {
  --primary: #1a56db;
  --primary-dark: #1e429f;
  --primary-light: #ebf5ff;
  --secondary: #0e9f6e;
  --accent: #ff5a1f;
  --danger: #e02424;
  --warning: #c27803;
  --bg: #f0f4ff;
  --sidebar-bg: #0f172a;
  --sidebar-text: #94a3b8;
  --sidebar-active: #1a56db;
  --card: #ffffff;
  --text: #1e293b;
  --text-light: #64748b;
  --border: #e2e8f0;
  --shadow: 0 4px 24px rgba(26,86,219,0.08);
  --radius: 14px;
  --font: 'Plus Jakarta Sans', sans-serif;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  display: flex;
  position: relative;
}

/* WATERMARK */
body::after {
  content: 'Created & Developed by D.D Candra';
  position: fixed;
  bottom: 18px;
  right: 22px;
  font-size: 10px;
  color: rgba(100,116,139,0.45);
  font-style: italic;
  font-family: var(--font);
  pointer-events: none;
  z-index: 9999;
  letter-spacing: 0.3px;
}

/* SIDEBAR */
#sidebar {
  width: 260px;
  min-height: 100vh;
  background: var(--sidebar-bg);
  padding: 0;
  display: flex;
  flex-direction: column;
  position: fixed;
  left: 0; top: 0; bottom: 0;
  z-index: 100;
  transition: transform 0.3s ease;
  overflow-y: auto;
}

.sidebar-header {
  padding: 22px 20px 16px;
  border-bottom: 1px solid #1e293b;
  display: flex;
  align-items: center;
  gap: 12px;
}

.sidebar-logo {
  width: 42px; height: 42px;
  border-radius: 10px;
  background: linear-gradient(135deg, var(--primary), #6366f1);
  display: flex; align-items: center; justify-content: center;
  font-weight: 800; font-size: 18px; color: white;
  overflow: hidden;
}

.sidebar-logo img { width: 100%; height: 100%; object-fit: cover; border-radius: 10px; }

.sidebar-title { flex: 1; }
.sidebar-title h2 { color: #fff; font-size: 15px; font-weight: 700; line-height: 1.2; }
.sidebar-title p { color: #64748b; font-size: 10px; margin-top: 2px; }

.school-name {
  padding: 10px 20px 6px;
  color: #64748b;
  font-size: 9px;
  font-weight: 600;
  letter-spacing: 1px;
  text-transform: uppercase;
}

.school-info {
  padding: 6px 20px 14px;
  border-bottom: 1px solid #1e293b;
}

.school-info span {
  color: #e2e8f0;
  font-size: 12px;
  font-weight: 600;
  display: block;
  margin-bottom: 2px;
}

.school-info small { color: #475569; font-size: 10px; }

nav { flex: 1; padding: 12px 0; }

.nav-label {
  color: #475569;
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 1.2px;
  text-transform: uppercase;
  padding: 10px 20px 4px;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 9px 20px;
  color: var(--sidebar-text);
  cursor: pointer;
  transition: all 0.18s;
  border-radius: 0;
  text-decoration: none;
  font-size: 13px;
  font-weight: 500;
  position: relative;
}

.nav-item:hover { background: #1e293b; color: #e2e8f0; }
.nav-item.active { background: rgba(26,86,219,0.2); color: #60a5fa; border-right: 3px solid #1a56db; }
.nav-item .icon { width: 18px; text-align: center; font-size: 15px; }
.nav-item .badge { margin-left: auto; background: var(--accent); color: white; border-radius: 99px; padding: 1px 7px; font-size: 10px; font-weight: 700; }

.nav-sub { padding-left: 20px; }
.nav-sub .nav-item { padding: 7px 20px 7px 36px; font-size: 12px; }

.sidebar-footer {
  padding: 14px 20px;
  border-top: 1px solid #1e293b;
}

.btn-logout {
  width: 100%;
  background: rgba(224,36,36,0.1);
  color: #f87171;
  border: 1px solid rgba(224,36,36,0.2);
  border-radius: 8px;
  padding: 8px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.18s;
  display: flex; align-items: center; justify-content: center; gap: 6px;
}

.btn-logout:hover { background: rgba(224,36,36,0.2); }

/* MAIN */
#main {
  margin-left: 260px;
  flex: 1;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.topbar {
  background: var(--card);
  border-bottom: 1px solid var(--border);
  padding: 12px 28px;
  display: flex;
  align-items: center;
  gap: 14px;
  position: sticky; top: 0;
  z-index: 50;
}

.topbar-title { font-size: 15px; font-weight: 700; color: var(--text); flex: 1; }
.topbar-sub { font-size: 12px; color: var(--text-light); font-weight: 400; }

.topbar-actions { display: flex; align-items: center; gap: 10px; }

#content { padding: 28px; flex: 1; }

/* CARDS & GRID */
.grid { display: grid; gap: 20px; }
.grid-2 { grid-template-columns: repeat(2, 1fr); }
.grid-3 { grid-template-columns: repeat(3, 1fr); }
.grid-4 { grid-template-columns: repeat(4, 1fr); }

.card {
  background: var(--card);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  padding: 22px;
  transition: box-shadow 0.2s;
}

.card:hover { box-shadow: 0 8px 32px rgba(26,86,219,0.13); }

.card-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 16px;
  padding-bottom: 14px;
  border-bottom: 1px solid var(--border);
}

.card-title { font-size: 15px; font-weight: 700; }

.stat-card {
  background: var(--card);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  padding: 20px 22px;
  display: flex; align-items: center; gap: 16px;
  transition: transform 0.18s, box-shadow 0.18s;
}

.stat-card:hover { transform: translateY(-2px); box-shadow: 0 10px 36px rgba(26,86,219,0.15); }

.stat-icon {
  width: 52px; height: 52px;
  border-radius: 12px;
  display: flex; align-items: center; justify-content: center;
  font-size: 22px;
}

.stat-info h3 { font-size: 26px; font-weight: 800; line-height: 1; }
.stat-info p { font-size: 12px; color: var(--text-light); margin-top: 4px; font-weight: 500; }

/* BUTTONS */
.btn {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 8px 16px;
  border-radius: 9px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  border: none;
  transition: all 0.18s;
  font-family: var(--font);
  white-space: nowrap;
}

.btn-primary { background: var(--primary); color: white; }
.btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }
.btn-success { background: var(--secondary); color: white; }
.btn-success:hover { background: #057a55; }
.btn-danger { background: var(--danger); color: white; }
.btn-danger:hover { background: #c81e1e; }
.btn-warning { background: #fbbf24; color: #78350f; }
.btn-outline { background: transparent; border: 1.5px solid var(--border); color: var(--text); }
.btn-outline:hover { background: var(--bg); }
.btn-print { background: #0f172a; color: white; }
.btn-print:hover { background: #1e293b; }
.btn-sm { padding: 5px 11px; font-size: 12px; }
.btn-lg { padding: 11px 22px; font-size: 14px; }

/* FORMS */
.form-group { margin-bottom: 16px; }
.form-label { display: block; font-size: 12px; font-weight: 600; color: var(--text-light); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
.form-control {
  width: 100%;
  padding: 9px 13px;
  border: 1.5px solid var(--border);
  border-radius: 9px;
  font-size: 13px;
  font-family: var(--font);
  color: var(--text);
  background: white;
  transition: border-color 0.18s, box-shadow 0.18s;
  outline: none;
}
.form-control:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(26,86,219,0.1); }
.form-control[type="file"] { padding: 7px 13px; }
textarea.form-control { resize: vertical; min-height: 80px; }

.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }

/* TABLE */
.table-wrap { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; font-size: 13px; }
th { background: #f8fafc; color: var(--text-light); font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; padding: 10px 12px; text-align: left; border-bottom: 2px solid var(--border); }
td { padding: 11px 12px; border-bottom: 1px solid var(--border); vertical-align: middle; }
tr:last-child td { border-bottom: none; }
tr:hover td { background: #f8fafc; }

/* BADGE */
.badge { display: inline-block; padding: 3px 9px; border-radius: 99px; font-size: 11px; font-weight: 700; }
.badge-primary { background: var(--primary-light); color: var(--primary); }
.badge-success { background: #d1fae5; color: #065f46; }
.badge-warning { background: #fef3c7; color: #92400e; }
.badge-danger { background: #fee2e2; color: #9b1c1c; }
.badge-gray { background: #f1f5f9; color: #64748b; }

/* MODAL */
.modal-overlay {
  position: fixed; inset: 0;
  background: rgba(15,23,42,0.55);
  backdrop-filter: blur(3px);
  z-index: 200;
  display: flex; align-items: center; justify-content: center;
  opacity: 0; pointer-events: none; transition: opacity 0.2s;
}
.modal-overlay.active { opacity: 1; pointer-events: all; }
.modal {
  background: white;
  border-radius: 18px;
  box-shadow: 0 24px 80px rgba(0,0,0,0.22);
  width: 92%; max-width: 560px;
  max-height: 90vh; overflow-y: auto;
  transform: translateY(18px); transition: transform 0.22s;
}
.modal-overlay.active .modal { transform: translateY(0); }
.modal-header { padding: 20px 24px 14px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
.modal-header h3 { font-size: 16px; font-weight: 700; }
.modal-body { padding: 20px 24px; }
.modal-footer { padding: 14px 24px 20px; display: flex; gap: 10px; justify-content: flex-end; }
.btn-close { background: none; border: none; cursor: pointer; font-size: 20px; color: var(--text-light); transition: color 0.15s; }
.btn-close:hover { color: var(--danger); }

/* TOAST */
#toast {
  position: fixed; bottom: 28px; left: 50%; transform: translateX(-50%) translateY(60px);
  background: #0f172a; color: white; padding: 11px 22px; border-radius: 99px;
  font-size: 13px; font-weight: 600; z-index: 9999;
  transition: transform 0.3s; pointer-events: none;
  box-shadow: 0 8px 32px rgba(0,0,0,0.3);
  white-space: nowrap;
}
#toast.show { transform: translateX(-50%) translateY(0); }
#toast.success { background: var(--secondary); }
#toast.error { background: var(--danger); }

/* LOGIN */
/* ======= LOGIN PAGE ======= */
#loginPage {
  position: fixed; inset: 0;
  background: linear-gradient(135deg, #0f172a 0%, #1a237e 50%, #1a56db 100%);
  display: flex; align-items: center; justify-content: center;
  z-index: 1000; overflow: hidden;
}
#loginPage.hide { display: none; }

/* Animated background orbs */
#loginPage::before, #loginPage::after {
  content: ''; position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.25; animation: orb 8s ease-in-out infinite;
}
#loginPage::before { width: 500px; height: 500px; background: #6366f1; top: -120px; left: -120px; }
#loginPage::after { width: 400px; height: 400px; background: #1a56db; bottom: -100px; right: -80px; animation-delay: -4s; }
@keyframes orb { 0%,100%{transform:translate(0,0) scale(1)} 50%{transform:translate(30px,-20px) scale(1.08)} }

.login-card {
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 28px; padding: 44px 42px; width: 400px;
  box-shadow: 0 40px 100px rgba(0,0,0,0.5);
  position: relative; z-index: 2;
  animation: cardIn 0.6s cubic-bezier(0.34,1.56,0.64,1) both;
}
@keyframes cardIn { from{opacity:0;transform:translateY(40px) scale(0.95)} to{opacity:1;transform:none} }

.login-logo { text-align: center; margin-bottom: 32px; }
.login-logo .app-icon {
  width: 72px; height: 72px;
  background: linear-gradient(135deg, #fff3 0%, #ffffff22 100%);
  border: 2px solid rgba(255,255,255,0.3);
  border-radius: 20px; display: inline-flex; align-items: center; justify-content: center;
  font-size: 32px; margin-bottom: 16px;
  box-shadow: 0 8px 32px rgba(26,86,219,0.3);
  animation: iconFloat 3s ease-in-out infinite;
}
@keyframes iconFloat { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }
.login-logo h1 { font-size: 26px; font-weight: 800; color: white; letter-spacing:-0.5px; }
.login-logo p { font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 5px; }

/* Floating input fields */
.float-group {
  position: relative; margin-bottom: 24px;
}
.float-group input {
  width: 100%; padding: 18px 16px 8px;
  background: rgba(255,255,255,0.08);
  border: 1.5px solid rgba(255,255,255,0.2);
  border-radius: 14px; font-size: 15px; font-weight: 500;
  color: white; outline: none;
  transition: all 0.25s ease;
  font-family: var(--font);
}
.float-group input::placeholder { color: transparent; }
.float-group input:focus {
  background: rgba(255,255,255,0.13);
  border-color: rgba(255,255,255,0.55);
  box-shadow: 0 0 0 4px rgba(255,255,255,0.08);
  transform: translateY(-2px);
}
.float-group label {
  position: absolute; left: 16px; top: 50%; transform: translateY(-50%);
  font-size: 14px; font-weight: 500; color: rgba(255,255,255,0.55);
  pointer-events: none; transition: all 0.22s cubic-bezier(0.4,0,0.2,1);
  transform-origin: left;
}
.float-group input:focus ~ label,
.float-group input:not(:placeholder-shown) ~ label {
  top: 10px; transform: translateY(0) scale(0.78);
  color: rgba(255,255,255,0.85); font-weight: 600;
}
.float-group .field-icon {
  position: absolute; right: 16px; top: 50%; transform: translateY(-50%);
  font-size: 18px; opacity: 0.5; pointer-events: none; transition: opacity 0.2s;
}
.float-group input:focus ~ .field-icon { opacity: 0.9; }

.btn-login {
  width: 100%; padding: 15px; border: none; cursor: pointer;
  background: linear-gradient(135deg, #ffffff22, #ffffff0a);
  border: 1.5px solid rgba(255,255,255,0.35);
  border-radius: 14px; font-size: 15px; font-weight: 700; color: white;
  font-family: var(--font); letter-spacing: 0.3px;
  transition: all 0.22s ease; position: relative; overflow: hidden;
  margin-top: 6px;
}
.btn-login::before {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(135deg, #1a56db, #6366f1);
  opacity: 0; transition: opacity 0.22s;
}
.btn-login:hover::before { opacity: 1; }
.btn-login:hover { transform: translateY(-2px); box-shadow: 0 12px 32px rgba(26,86,219,0.4); }
.btn-login:active { transform: translateY(0) scale(0.98); }
.btn-login span { position: relative; z-index: 1; }
.login-footer { text-align: center; margin-top: 18px; font-size: 13px; color: rgba(255,255,255,0.5); }
.login-footer a { color: rgba(255,255,255,0.9); font-weight: 700; text-decoration: none; }
.login-footer a:hover { color: white; }

/* SETUP / CONFIG */
#setupPage {
  position: fixed; inset: 0;
  background: var(--bg);
  display: flex; align-items: center; justify-content: center;
  z-index: 900;
  overflow-y: auto;
}
#setupPage.hide { display: none; }
.setup-card { background: white; border-radius: 20px; padding: 36px 38px; width: 560px; box-shadow: var(--shadow); border: 1px solid var(--border); }
.setup-card h2 { font-size: 20px; font-weight: 800; margin-bottom: 6px; }
.setup-card p { font-size: 13px; color: var(--text-light); margin-bottom: 26px; }

/* TABS */
.tabs { display: flex; gap: 4px; background: var(--bg); border-radius: 10px; padding: 4px; margin-bottom: 20px; }
.tab { flex: 1; text-align: center; padding: 8px; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; color: var(--text-light); transition: all 0.18s; }
.tab.active { background: white; color: var(--primary); box-shadow: 0 2px 8px rgba(26,86,219,0.12); }

/* ABSENSI GRID */
.absen-grid { display: grid; gap: 3px; }
.absen-row { display: grid; grid-template-columns: 1fr repeat(4, 36px); gap: 6px; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border); }
.absen-row:last-child { border-bottom: none; }
.absen-name { font-size: 13px; font-weight: 600; }
.absen-options { display: flex; gap: 4px; }
.absen-opt { width: 34px; height: 34px; border-radius: 8px; border: 2px solid var(--border); cursor: pointer; font-size: 11px; font-weight: 700; display: flex; align-items: center; justify-content: center; transition: all 0.15s; background: white; }
.absen-opt.H.sel { background: var(--secondary); color: white; border-color: var(--secondary); }
.absen-opt.S.sel { background: #f59e0b; color: white; border-color: #f59e0b; }
.absen-opt.I.sel { background: var(--primary); color: white; border-color: var(--primary); }
.absen-opt.A.sel { background: var(--danger); color: white; border-color: var(--danger); }

/* NILAI INPUT */
.nilai-row { display: grid; grid-template-columns: 1fr 100px; gap: 10px; align-items: center; padding: 9px 0; border-bottom: 1px solid var(--border); }
.nilai-row:last-child { border-bottom: none; }
.nilai-name { font-size: 13px; font-weight: 600; }
.nilai-input { text-align: center; padding: 7px; border: 1.5px solid var(--border); border-radius: 8px; font-size: 14px; font-weight: 700; color: var(--primary); outline: none; }
.nilai-input:focus { border-color: var(--primary); }

/* INTEGRASI */
.integration-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 14px; }
.integration-card {
  background: var(--card); border-radius: 14px; border: 1.5px solid var(--border);
  padding: 18px; display: flex; flex-direction: column; align-items: center; gap: 10px;
  text-align: center; cursor: pointer; transition: all 0.2s; text-decoration: none; color: var(--text);
  position: relative;
}
.integration-card:hover { border-color: var(--primary); transform: translateY(-3px); box-shadow: 0 12px 32px rgba(26,86,219,0.14); }
.integration-icon { width: 50px; height: 50px; border-radius: 12px; background: var(--primary-light); display: flex; align-items: center; justify-content: center; font-size: 22px; }
.integration-name { font-size: 13px; font-weight: 700; }
.integration-url { font-size: 10px; color: var(--text-light); word-break: break-all; }
.integration-del { position: absolute; top: 8px; right: 8px; background: none; border: none; cursor: pointer; color: var(--danger); font-size: 14px; opacity: 0; transition: opacity 0.15s; }
.integration-card:hover .integration-del { opacity: 1; }
/* ======= CARD CLICK ANIMATIONS ======= */
.stat-card, .card, .integration-card, .nav-item {
  transition: all 0.2s cubic-bezier(0.34,1.3,0.64,1);
}
.stat-card:hover { transform: translateY(-4px) scale(1.02); box-shadow: 0 12px 36px rgba(26,86,219,0.14); }
.stat-card:active { transform: scale(0.97); }
.card { transition: box-shadow 0.2s, transform 0.2s; }

/* Nav item click ripple */
.nav-item { position: relative; overflow: hidden; }
.nav-item::after {
  content: ''; position: absolute; inset: 0;
  background: rgba(255,255,255,0.08); opacity: 0;
  transition: opacity 0.15s;
}
.nav-item:active::after { opacity: 1; }
.nav-item:active { transform: scale(0.97); }

/* Page transition */
.page { animation: pageIn 0.3s ease both; }
@keyframes pageIn { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:none} }

/* ======= INTEGRATION GRID REDESIGN ======= */
.integration-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 16px;
}
.integration-card {
  background: var(--card);
  border-radius: 18px;
  border: 1.5px solid var(--border);
  padding: 22px 16px 16px;
  display: flex; flex-direction: column; align-items: center; gap: 10px;
  text-align: center; cursor: pointer;
  transition: all 0.25s cubic-bezier(0.34,1.3,0.64,1);
  text-decoration: none; color: var(--text);
  position: relative; overflow: hidden;
}
.integration-card::before {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(135deg, var(--primary-light), transparent);
  opacity: 0; transition: opacity 0.25s;
}
.integration-card:hover {
  border-color: var(--primary);
  transform: translateY(-6px) scale(1.03);
  box-shadow: 0 16px 40px rgba(26,86,219,0.18);
}
.integration-card:hover::before { opacity: 1; }
.integration-card:active { transform: scale(0.97); }
.integration-icon {
  width: 56px; height: 56px; border-radius: 14px;
  background: linear-gradient(135deg, var(--primary-light), #dbeafe);
  display: flex; align-items: center; justify-content: center;
  font-size: 26px; position: relative; z-index: 1;
  transition: transform 0.25s cubic-bezier(0.34,1.5,0.64,1);
  overflow: hidden;
}
.integration-card:hover .integration-icon { transform: scale(1.15) rotate(-5deg); }
.integration-icon img { width: 100%; height: 100%; object-fit: cover; border-radius: 10px; }
.integration-name { font-size: 13px; font-weight: 700; position: relative; z-index: 1; }
.integration-url { font-size: 10px; color: var(--text-light); position: relative; z-index: 1; }
.integration-actions {
  position: absolute; top: 8px; right: 8px;
  display: flex; gap: 4px; opacity: 0;
  transition: opacity 0.18s; z-index: 2;
}
.integration-card:hover .integration-actions { opacity: 1; }
.integration-del, .integration-edit {
  width: 26px; height: 26px; border-radius: 8px; border: none; cursor: pointer;
  font-size: 12px; display: flex; align-items: center; justify-content: center;
}
.integration-del { background: #fee2e2; color: #e02424; }
.integration-edit { background: #dbeafe; color: #1a56db; }
.integration-del:hover { background: #e02424; color: white; }
.integration-edit:hover { background: #1a56db; color: white; }


/* KOP SURAT */
.kop-preview {
  border: 1px solid var(--border); border-radius: 10px; padding: 18px; margin-bottom: 14px; background: #f8fafc;
}
.kop-preview .kop-logo { width: 60px; height: 60px; object-fit: contain; }
.kop-preview-inner { display: flex; gap: 14px; align-items: center; }
.kop-text { flex: 1; border-left: 3px solid var(--primary); padding-left: 14px; }
.kop-text h3 { font-size: 15px; font-weight: 800; color: var(--text); }
.kop-text p { font-size: 11px; color: var(--text-light); margin-top: 3px; }

/* JURNAL */
.jurnal-card { background: var(--card); border-radius: 12px; border: 1px solid var(--border); padding: 16px 18px; margin-bottom: 10px; }
.jurnal-meta { font-size: 11px; color: var(--text-light); margin-bottom: 6px; }
.jurnal-content { font-size: 13px; line-height: 1.6; }

/* PROGRESS BARS */
.progress-bar { background: var(--border); border-radius: 99px; height: 7px; overflow: hidden; }
.progress-fill { height: 100%; border-radius: 99px; background: var(--primary); transition: width 0.4s; }

/* RESPONSIVE - TABLET */
@media (max-width: 900px) {
  #sidebar { transform: translateX(-260px); box-shadow: none; }
  #sidebar.open { transform: translateX(0); box-shadow: 4px 0 24px rgba(0,0,0,0.35); }
  #main { margin-left: 0; }
  .grid-4 { grid-template-columns: repeat(2, 1fr); }
  .grid-3 { grid-template-columns: repeat(2, 1fr); }
  .topbar { padding: 10px 16px; }
}

/* RESPONSIVE - MOBILE */
@media (max-width: 600px) {
  .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
  #content { padding: 12px; }

  .topbar { padding: 10px 12px; gap: 8px; }
  .topbar-title { font-size: 13px; }
  .topbar-sub { display: none; }
  .topbar-actions { gap: 6px; }

  .section-header { flex-direction: column; align-items: flex-start; gap: 10px; }
  .section-header > div:last-child { width: 100%; display: flex; flex-wrap: wrap; gap: 6px; }
  .section-header .btn { flex: 1; min-width: 120px; justify-content: center; font-size: 12px; padding: 7px 10px; }

  .card { padding: 14px; }
  .card-header { flex-direction: column; align-items: flex-start; gap: 8px; }

  .stat-card { padding: 14px 16px; }
  .stat-icon { width: 42px; height: 42px; font-size: 18px; }
  .stat-info h3 { font-size: 22px; }

  .table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; border-radius: 10px; }
  table { min-width: 480px; font-size: 12px; }
  th, td { padding: 8px 10px; }

  .btn { font-size: 12px; padding: 7px 12px; }
  .btn-lg { font-size: 13px; padding: 10px 18px; }

  .form-row { grid-template-columns: 1fr; gap: 10px; }
  .form-control { font-size: 14px; }

  .modal { width: 96%; border-radius: 16px; max-height: 88vh; }
  .modal-header { padding: 14px 16px 10px; }
  .modal-body { padding: 14px 16px; }
  .modal-footer { padding: 10px 16px 16px; flex-direction: column; }
  .modal-footer .btn { width: 100%; justify-content: center; }

  .login-card { width: 92%; padding: 32px 24px; }
  .login-logo h1 { font-size: 22px; }

  .integration-grid { grid-template-columns: repeat(2, 1fr) !important; gap: 10px !important; }

  #sidebarBackdrop {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.5); z-index: 99;
  }
  #sidebarBackdrop.show { display: block; }

  #page-siswa .section-header { flex-direction: column; align-items: flex-start; gap: 8px; }
  #page-siswa .section-header > div { display: flex; flex-wrap: wrap; gap: 6px; width: 100%; }
  #page-siswa .section-header select { width: 100%; }
  #page-siswa .section-header .btn { flex: 1 1 calc(50% - 3px); text-align: center; justify-content: center; }

  #toast { bottom: 80px; font-size: 12px; padding: 9px 18px; }
  body::after { display: none; }
}

/* PAGE HIDE */
.page { display: none; }
.page.active { display: block; }

/* Scroll */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: #f1f5f9; }
::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

/* SECTION HEADER */
.section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
.section-title { font-size: 18px; font-weight: 800; color: var(--text); }
.section-sub { font-size: 13px; color: var(--text-light); margin-top: 2px; }

/* EMPTY STATE */
.empty-state { text-align: center; padding: 50px 20px; }
.empty-state .empty-icon { font-size: 48px; margin-bottom: 14px; }
.empty-state h3 { font-size: 16px; font-weight: 700; margin-bottom: 6px; }
.empty-state p { font-size: 13px; color: var(--text-light); }

/* BURGER */
.burger { display: none; cursor: pointer; font-size: 22px; color: var(--text); }
@media (max-width: 900px) { .burger { display: block; } }

/* LOADING */
.loading { display: inline-block; width: 18px; height: 18px; border: 2px solid rgba(255,255,255,0.4); border-top-color: white; border-radius: 50%; animation: spin 0.7s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* Alert */
.alert { padding: 12px 16px; border-radius: 10px; font-size: 13px; font-weight: 500; margin-bottom: 16px; }
.alert-warning { background: #fef3c7; border: 1px solid #fde68a; color: #92400e; }
.alert-info { background: var(--primary-light); border: 1px solid #bfdbfe; color: var(--primary-dark); }

/* Rekap nilai table */
.rekap-table th, .rekap-table td { font-size: 12px; padding: 9px 10px; }
.score-cell { text-align: center; font-weight: 700; }
.score-high { color: var(--secondary); }
.score-mid { color: var(--warning); }
.score-low { color: var(--danger); }
.avg-col { background: var(--primary-light); color: var(--primary); font-weight: 800; }

/* BIMBINGAN */
.bimbingan-item { padding: 14px; background: var(--bg); border-radius: 10px; margin-bottom: 10px; }
.bimbingan-meta { font-size: 11px; color: var(--text-light); margin-bottom: 6px; display: flex; gap: 10px; }
.bimbingan-desc { font-size: 13px; color: var(--text); margin-bottom: 4px; font-weight: 600; }
.bimbingan-sol { font-size: 12px; color: var(--text-light); font-style: italic; }

</style>
</head>
<body>

<!-- WATERMARK visible label in footer -->
<div id="toast"></div>

<!-- ===================== LOGIN PAGE ===================== -->
<div id="loginPage">
  <div class="login-card">
    <div class="login-logo">
      <div class="app-icon" id="loginLogo"><img src="data:image/png;base64,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" alt="APEL JUMBO" style="width:100%;height:100%;object-fit:contain;border-radius:50%;"></div>
      <h1 id="loginAppName">APEL JUMBO Reborn</h1>
      <p id="loginSubtitle">Aplikasi Elektronik Jurnal Mengajar Berbasis Online</p>
    </div>
    <div class="float-group">
      <input type="email" id="loginEmail" placeholder="email" autocomplete="email">
      <label>Email</label>
      <span class="field-icon"></span>
    </div>
    <div class="float-group">
      <input type="password" id="loginPass" placeholder="password" autocomplete="current-password">
      <label>Password</label>
      <span class="field-icon"></span>
    </div>
    <button class="btn-login" onclick="doLogin()">
      <span id="loginBtnText">Masuk </span>
    </button>
    <p class="login-footer">
      Belum punya akun? <a href="#" onclick="doRegister()">Daftar sekarang</a>
    </p>
  </div>
</div>

<!-- ===================== SETUP PAGE ===================== -->
<div id="setupPage" class="hide">
  <div class="setup-card">
    <h2> Konfigurasi Aplikasi</h2>
    <p>Masukkan kredensial Supabase dan informasi sekolah Anda untuk mulai menggunakan APEL JUMBO.</p>
    
    <div style="margin-bottom:20px;">
      <h3 style="font-size:14px;font-weight:700;margin-bottom:14px;color:var(--primary)"> Koneksi Supabase</h3>
      <div class="form-group">
        <!-- Supabase fields hidden -->
      </div>
      <div class="form-group">
        <!-- Supabase key hidden -->
      </div>
    </div>
    
    <div style="margin-bottom:20px;">
      <h3 style="font-size:14px;font-weight:700;margin-bottom:14px;color:var(--primary)"> Informasi Sekolah (Kop Surat)</h3>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Nama Sekolah</label>
          <input type="text" id="cfgSchool" class="form-control" placeholder="SMP Nusantara">
        </div>
        <div class="form-group">
          <label class="form-label">NPSN</label>
          <input type="text" id="cfgNpsn" class="form-control" placeholder="12345678">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Alamat Sekolah</label>
        <input type="text" id="cfgAddress" class="form-control" placeholder="Jl. Pendidikan No.1, Kota...">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Telepon</label>
          <input type="text" id="cfgPhone" class="form-control" placeholder="(021) 123456">
        </div>
        <div class="form-group">
          <label class="form-label">Subtitle / Tagline</label>
          <input type="text" id="cfgSubtitle" class="form-control" placeholder="Kabupaten / Kota...">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Logo Sekolah (Upload)</label>
        <input type="file" id="cfgLogo" class="form-control" accept="image/*" onchange="previewLogo(this)">
        <div id="logoPreviewWrap" style="margin-top:8px;display:none">
          <img id="logoPreview" src="" style="height:60px;border-radius:8px;border:1px solid var(--border)">
        </div>
      </div>
    </div>
    
    <button class="btn btn-primary btn-lg" style="width:100%" onclick="saveConfig()">Simpan & Lanjutkan </button>
    <button class="btn btn-outline" style="width:100%;margin-top:8px" onclick="goBackLogin()"> Kembali ke Login</button>
  </div>
</div>

<!-- Backdrop overlay for mobile sidebar -->
<div id="sidebarBackdrop" onclick="closeSidebar()"></div>

<!-- ===================== SIDEBAR ===================== -->
<div id="sidebar">
  <div class="sidebar-header">
    <div class="sidebar-logo" id="sidebarLogo"><img src="data:image/png;base64,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" alt="APEL JUMBO" style="width:100%;height:100%;object-fit:cover;border-radius:10px;"></div>
    <div class="sidebar-title">
      <h2 id="sidebarAppName">APEL JUMBO Reborn</h2>
      <p>Aplikasi Elektronik Jurnal Mengajar Berbasis Online v1.0</p>
    </div>
  </div>
  <div class="school-name">Sekolah</div>
  <div class="school-info">
    <span id="sidebarSchoolName">Loading...</span>
    <small id="sidebarSchoolSub">-</small>
  </div>
  <nav>
    <div class="nav-label">Utama</div>
    <div class="nav-item active" onclick="showPage('dashboard')">
      <span class="icon"></span> Dashboard
    </div>
    <div class="nav-item" onclick="showPage('siswa')">
      <span class="icon"></span> Data Siswa
    </div>
    <div class="nav-item" onclick="showPage('jadwal')">
      <span class="icon"></span> Jadwal Mengajar
    </div>
    
    <div class="nav-label">Administrasi</div>
    <div class="nav-item" onclick="showPage('absensi')">
      <span class="icon"></span> Absensi
    </div>
    <div class="nav-item" onclick="showPage('absenRekap')">
      <span class="icon"></span> Rekap Absensi
    </div>
    <div class="nav-item" onclick="showPage('nilai')">
      <span class="icon"></span> Input Nilai
    </div>
    <div class="nav-item" onclick="showPage('nilaiRekap')">
      <span class="icon"></span> Rekap Nilai
    </div>
    <div class="nav-item" onclick="showPage('jurnal')">
      <span class="icon"></span> Jurnal Mengajar
    </div>
    <div class="nav-item" onclick="showPage('bimbingan')">
      <span class="icon"></span> Bimbingan Wali
    </div>
    
    <div class="nav-label">UMMI</div>
    <div class="nav-item" onclick="showPage('ummiTingkatan')">
      <span class="icon"></span> Tingkatan UMMI
    </div>
    <div class="nav-item" onclick="showPage('ummi7')">
      <span class="icon"></span> Pembayaran UMMI 7
    </div>
    <div class="nav-item" onclick="showPage('ummi8')">
      <span class="icon"></span> Pembayaran UMMI 8
    </div>
    <div class="nav-item" onclick="showPage('ummi9')">
      <span class="icon"></span> Pembayaran UMMI 9
    </div>
    <div class="nav-label">Lainnya</div>
    <div class="nav-item" onclick="showPage('integrasi')">
      <span class="icon"></span> Integrasi ASN
    </div>
    <div class="nav-item" onclick="showPage('integrasiKinerja')">
      <span class="icon"></span> Shortcut App
    </div>
    <div class="nav-item" onclick="showPage('pengaturan')">
      <span class="icon"></span> Pengaturan
    </div>
  </nav>
  <div class="sidebar-footer">
    <div style="font-size:10px;color:#475569;margin-bottom:8px;text-align:center">
      Created & Developed by D.D Candra
    </div>
    <button class="btn-logout" onclick="doLogout()"> Keluar</button>
  </div>
</div>

<!-- ===================== MAIN CONTENT ===================== -->
<div id="main">
  <div class="topbar">
    <span class="burger" onclick="toggleSidebar()"></span>
    <div class="topbar-title">
      <span id="pageTitle">Dashboard</span>
    </div>
    <div class="topbar-actions">
      <span id="guruTopbar" style="font-size:12px;color:var(--text-light);font-weight:600"></span>
    </div>
  </div>

  <div id="content">
    <!-- ===== DASHBOARD ===== -->
    <div id="page-dashboard" class="page active">
      <div class="section-header">
        <div>
          <div class="section-title">Dashboard</div>
          <div class="section-sub" id="dashGreeting">Selamat datang di APEL JUMBO</div>
        </div>
        <span id="dashDate" style="font-size:13px;color:var(--text-light);font-weight:600"></span>
      </div>
      <!-- Guru Info Card -->
      <div id="guruInfoCard" class="card" style="margin-bottom:20px;display:none">
        <div style="display:flex;align-items:center;gap:18px">
          <div style="width:58px;height:58px;border-radius:50%;background:linear-gradient(135deg,var(--primary),#6366f1);display:flex;align-items:center;justify-content:center;font-size:24px;color:white;font-weight:800;flex-shrink:0" id="guruAvatar">G</div>
          <div style="flex:1">
            <div style="font-size:18px;font-weight:800;color:var(--text)" id="dashGuruNama">-</div>
            <div style="font-size:12px;color:var(--text-light);margin-top:2px" id="dashGuruWali">-</div>
          </div>
          <div style="text-align:right">
            <div style="font-size:11px;color:var(--text-light)">Tahun Pelajaran</div>
            <div style="font-size:13px;font-weight:700;color:var(--primary)" id="dashTP">-</div>
          </div>
        </div>
      </div>
      <div class="grid grid-4" id="statCards" style="margin-bottom:24px"></div>
      <div class="grid grid-2">
        <div class="card">
          <div class="card-header">
            <span class="card-title"> Jadwal Hari Ini</span>
          </div>
          <div id="jadwalToday"></div>
        </div>
        <div class="card">
          <div class="card-header">
            <span class="card-title"> Jurnal Terbaru</span>
          </div>
          <div id="jurnalRecent"></div>
        </div>
      </div>
    </div>

    <!-- ===== SISWA ===== -->
    <div id="page-siswa" class="page">
      <div class="section-header">
        <div>
          <div class="section-title">Data Siswa</div>
          <div class="section-sub">Kelola data siswa per kelas</div>
        </div>
        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <select id="filterKelasS" class="form-control" style="width:140px" onchange="loadSiswa()">
            <option value="">Semua Kelas</option>
          </select>
          <button class="btn btn-outline" onclick="downloadTemplateSiswa()" title="Download template Excel">
             Template Excel
          </button>
          <label class="btn btn-success" style="cursor:pointer;margin:0" title="Upload file Excel siswa">
             Upload Excel
            <input type="file" id="uploadExcelSiswa" accept=".xlsx,.xls" style="display:none" onchange="uploadExcelSiswa(this)">
          </label>
          <button class="btn btn-primary" onclick="showAddSiswa()">+ Tambah Siswa</button>
          <button class="btn btn-print" onclick="cetakSiswa()"> Cetak</button>
        </div>
      </div>
      <!-- Progress upload -->
      <div id="uploadProgress" style="display:none;margin-bottom:16px">
        <div class="card" style="padding:16px">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
            <span style="font-size:13px;font-weight:600" id="uploadStatusText">Mengupload data...</span>
            <span id="uploadCount" style="font-size:12px;color:var(--text-light)"></span>
          </div>
          <div class="progress-bar"><div class="progress-fill" id="uploadProgressBar" style="width:0%"></div></div>
        </div>
      </div>
      
<div class="card">
        <div class="table-wrap">
          <table>
            <thead>
              <tr><th>NISN</th><th>Nama Lengkap</th><th>Kelas</th><th>Jenis Kelamin</th><th>Bimbingan Wali</th><th>Aksi</th></tr>
            </thead>
            <tbody id="siswaTbody"><tr><td colspan="6" style="text-align:center;padding:30px;color:var(--text-light)">Memuat data...</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ===== JADWAL ===== -->
    <div id="page-jadwal" class="page">
      <div class="section-header">
        <div><div class="section-title">Jadwal Mengajar</div></div>
        <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
          <select id="filterJadwalKelas" class="form-control" style="width:140px" onchange="renderJadwal()">
            <option value="">Semua Kelas</option>
          </select>
          <select id="filterJadwalMapel" class="form-control" style="width:160px" onchange="renderJadwal()">
            <option value="">Semua Mapel</option>
          </select>
          <select id="filterJadwalHari" class="form-control" style="width:130px" onchange="renderJadwal()">
            <option value="">Semua Hari</option>
            <option>Senin</option><option>Selasa</option><option>Rabu</option>
            <option>Kamis</option><option>Jumat</option><option>Sabtu</option>
          </select>
          <button class="btn btn-primary" onclick="showAddJadwal()">+ Tambah</button>
          <button class="btn btn-print" onclick="cetakJadwal()"> Cetak</button>
        </div>
      </div>
      <div class="card">
        <div class="table-wrap">
          <table>
            <thead><tr><th>Hari</th><th>Jam</th><th>Kelas</th><th>Mata Pelajaran</th><th>Ruang</th><th>Aksi</th></tr></thead>
            <tbody id="jadwalTbody"><tr><td colspan="6" style="text-align:center;padding:30px;color:var(--text-light)">Memuat data...</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ===== ABSENSI ===== -->
    <div id="page-absensi" class="page">
      <div class="section-header">
        <div><div class="section-title">Input Absensi</div></div>
      </div>
      <div class="card" style="max-width:600px">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Kelas</label>
            <select id="absenKelas" class="form-control" onchange="loadSiswaAbsen()"></select>
          </div>
          <div class="form-group">
            <label class="form-label">Tanggal</label>
            <input type="date" id="absenDate" class="form-control">
          </div>
        </div>
        <div style="margin-bottom:12px">
          <div style="display:grid;grid-template-columns:1fr repeat(4,36px);gap:6px;padding:8px 0;border-bottom:2px solid var(--border)">
            <span style="font-size:11px;font-weight:700;color:var(--text-light)">NAMA SISWA</span>
            <span style="text-align:center;font-size:11px;font-weight:700;color:var(--secondary)">H</span>
            <span style="text-align:center;font-size:11px;font-weight:700;color:#f59e0b">S</span>
            <span style="text-align:center;font-size:11px;font-weight:700;color:var(--primary)">I</span>
            <span style="text-align:center;font-size:11px;font-weight:700;color:var(--danger)">A</span>
          </div>
          <div id="absenList"></div>
        </div>
        <button class="btn btn-success btn-lg" style="width:100%" onclick="simpanAbsen()"> Simpan Absensi</button>
      </div>
    </div>

    <!-- ===== REKAP ABSENSI ===== -->
    <div id="page-absenRekap" class="page">
      <div class="section-header">
        <div><div class="section-title">Rekap & Cetak Absensi</div></div>
        <button class="btn btn-print" onclick="cetakAbsensi()"> Cetak PDF</button>
      </div>
      <div class="card" style="margin-bottom:20px">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Filter Kelas</label>
            <select id="rekapAbsenKelas" class="form-control" onchange="loadRekapAbsen()"></select>
          </div>
          <div class="form-group">
            <label class="form-label">Filter Mata Pelajaran</label>
            <select id="rekapAbsenMapel" class="form-control" onchange="loadRekapAbsen()">
              <option value="">Semua Mapel</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Filter Periode (Bulan)</label>
            <select id="rekapAbsenBulan" class="form-control" onchange="loadRekapAbsen()"></select>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="table-wrap">
          <table class="rekap-table">
            <thead>
              <tr><th>Nama Murid</th><th>Kelas</th><th>Jml Hari</th><th style="color:var(--secondary)">H</th><th style="color:#f59e0b">S</th><th style="color:var(--primary)">I</th><th style="color:var(--danger)">A</th><th>% Hadir</th></tr>
            </thead>
            <tbody id="rekapAbsenTbody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ===== INPUT NILAI ===== -->
    <div id="page-nilai" class="page">
      <div class="section-header">
        <div><div class="section-title">Input Nilai Akademik</div></div>
      </div>
      <div class="card" style="max-width:620px">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Kelas</label>
            <select id="nilaiKelas" class="form-control" onchange="updateNilaiMapel()"></select>
          </div>
          <div class="form-group">
            <label class="form-label">Mapel (dari Jadwal)</label>
            <select id="nilaiMapel" class="form-control"></select>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Kategori Nilai</label>
          <select id="nilaiKategori" class="form-control">
            <option value="PR">PR (Pekerjaan Rumah)</option>
            <option value="Harian">Harian</option>
            <option value="Tugas">Tugas</option>
            <option value="Projek">Projek</option>
            <option value="Portofolio">Portofolio</option>
            <option value="Sumatif">Sumatif</option>
            <option value="STS">STS (Sumatif Tengah Semester)</option>
            <option value="SAS">SAS (Sumatif Akhir Semester)</option>
          </select>
        </div>
        <button class="btn btn-primary" onclick="loadSiswaNilai()" style="margin-bottom:20px">Buka Form </button>
        <div id="nilaiFormContainer"></div>
      </div>
    </div>

    <!-- ===== REKAP NILAI ===== -->
    <div id="page-nilaiRekap" class="page">
      <div class="section-header">
        <div><div class="section-title">Rekapitulasi Nilai Siswa</div></div>
        <button class="btn btn-print" onclick="cetakNilai()"> Cetak PDF</button>
      </div>
      <div class="card" style="margin-bottom:20px">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Pilih Kelas</label>
            <select id="rekapNilaiKelas" class="form-control" onchange="updateRekapMapel()"></select>
          </div>
          <div class="form-group">
            <label class="form-label">Pilih Mata Pelajaran</label>
            <select id="rekapNilaiMapel" class="form-control" onchange="loadRekapNilai()"></select>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="table-wrap">
          <table class="rekap-table" id="rekapNilaiTable">
            <thead>
              <tr>
                <th>Nama Siswa</th>
                <th class="score-cell">PR</th>
                <th class="score-cell">HRN</th>
                <th class="score-cell">TGS</th>
                <th class="score-cell">PRJ</th>
                <th class="score-cell">PFT</th>
                <th class="score-cell">SUM</th>
                <th class="score-cell">STS</th>
                <th class="score-cell">SAS</th>
                <th class="score-cell avg-col">AVG</th>
              </tr>
            </thead>
            <tbody id="rekapNilaiTbody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ===== JURNAL ===== -->
    <div id="page-jurnal" class="page">
      <div class="section-header">
        <div><div class="section-title">Jurnal Mengajar</div></div>
        <div style="display:flex;gap:10px">
          <button class="btn btn-primary" onclick="showAddJurnal()">+ Tambah Jurnal</button>
          <button class="btn btn-print" onclick="cetakJurnal()"> Cetak PDF</button>
        </div>
      </div>
      <div class="card" style="margin-bottom:16px">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Filter Kelas</label>
            <select id="filterJurnalKelas" class="form-control" onchange="loadJurnal()"></select>
          </div>
          <div class="form-group">
            <label class="form-label">Filter Mata Pelajaran</label>
            <select id="filterJurnalMapel" class="form-control" onchange="loadJurnal()">
              <option value="">Semua Mapel</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Filter Bulan</label>
            <select id="filterJurnalBulan" class="form-control" onchange="loadJurnal()"></select>
          </div>
        </div>
      </div>
      <div id="jurnalList"></div>
    </div>

    <!-- ===== BIMBINGAN ===== -->
    <div id="page-bimbingan" class="page">
      <div class="section-header">
        <div><div class="section-title">Bimbingan Wali Kelas</div></div>
        <div style="display:flex;gap:10px">
          <button class="btn btn-primary" onclick="showAddBimbingan()">+ Catat Bimbingan</button>
          <button class="btn btn-print" onclick="cetakBimbingan()"> Cetak PDF</button>
        </div>
      </div>
      <div class="card" style="margin-bottom:16px">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Filter Siswa</label>
            <select id="filterBimbinganSiswa" class="form-control" onchange="loadBimbingan()">
              <option value="">Semua Siswa</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Filter Kategori</label>
            <select id="filterBimbinganKat" class="form-control" onchange="loadBimbingan()">
              <option value="">Semua Kategori</option>
              <option>Akademik</option><option>Sosial</option><option>Pribadi</option><option>Karir</option>
            </select>
          </div>
        </div>
      </div>
      <div id="bimbinganList"></div>
    </div>

    <!-- ===== INTEGRASI ===== -->
    <div id="page-integrasi" class="page">
      <div class="section-header">
        <div>
          <div class="section-title"> Integrasi Layanan ASN</div>
          <div class="section-sub">Shortcut cepat menuju portal kedinasan</div>
        </div>
        <button class="btn btn-primary" onclick="showAddIntegrasi()">+ Tambah Link</button>
      </div>
      <div class="alert alert-info" style="margin-bottom:20px">
         Klik ikon untuk membuka layanan langsung di tab baru. Hover untuk opsi hapus.
      </div>
      <div class="integration-grid" id="integrasiGrid"></div>
    </div>

    <!-- ===== INTEGRASI KINERJA ===== -->
    <div id="page-integrasiKinerja" class="page">
      <div class="section-header">
        <div>
          <div class="section-title"> Integrasi Kinerja</div>
          <div class="section-sub">Shortcut cepat menuju portal penilaian & pelaporan kinerja</div>
        </div>
        <button class="btn btn-primary" onclick="showAddKinerja()">+ Tambah Link</button>
      </div>
      <div class="alert alert-info" style="margin-bottom:20px">
         Klik ikon untuk membuka layanan langsung di tab baru. Hover untuk opsi edit / hapus.
      </div>
      <div class="integration-grid" id="kinerjaGrid"></div>
    </div>

    <!-- ===== PENGATURAN ===== -->
    <div id="page-pengaturan" class="page">
      <div class="section-header">
        <div><div class="section-title">Pengaturan Aplikasi</div></div>
        <button class="btn btn-primary" onclick="savePengaturan()"> Simpan Perubahan</button>
      </div>
      <div class="grid grid-2">
        <div class="card">
          <div class="card-header"><span class="card-title"> Informasi Sekolah</span></div>
          <div class="form-group">
            <label class="form-label">Nama Sekolah</label>
            <input type="text" id="setSchool" class="form-control">
          </div>
          <div class="form-group">
            <label class="form-label">Subtitle / Tagline</label>
            <input type="text" id="setSubtitle" class="form-control">
          </div>
          <div class="form-group">
            <label class="form-label">NPSN</label>
            <input type="text" id="setNpsn" class="form-control">
          </div>
          <div class="form-group">
            <label class="form-label">Alamat</label>
            <input type="text" id="setAddress" class="form-control">
          </div>
          <div class="form-group">
            <label class="form-label">Telepon</label>
            <input type="text" id="setPhone" class="form-control">
          </div>
        </div>
        <div class="card">
          <div class="card-header"><span class="card-title"> Logo & Tampilan</span></div>
          <div class="form-group">
            <label class="form-label">Upload Logo Baru</label>
            <input type="file" id="setLogo" class="form-control" accept="image/*" onchange="updateLogoPreview(this)">
          </div>
          <div id="setLogoPreviewWrap" style="margin-bottom:16px">
            <img id="setLogoPreview" src="" style="height:70px;border-radius:10px;border:1px solid var(--border);display:none">
          </div>
          <!-- Supabase config hidden from UI, still saved internally -->
          <div style="display:none">
            <input type="text" id="setSupaUrl" class="form-control">
            <input type="text" id="setSupaKey" class="form-control">
          </div>
          <div style="border-top:1px solid var(--border);margin:16px 0;padding-top:16px">
            <div style="font-size:12px;font-weight:700;color:var(--text-light);margin-bottom:12px"> BRANDING APLIKASI</div>
            <div class="form-group">
              <label class="form-label">Nama Aplikasi (tampil di login)</label>
              <input type="text" id="setAppName" class="form-control" placeholder="APEL JUMBO">
            </div>
            <div class="form-group">
              <label class="form-label">Subtitle Aplikasi</label>
              <input type="text" id="setAppSubtitle" class="form-control" placeholder="Aplikasi Elektronik Jurnal Mengajar Berbasis Online">
            </div>
            <div class="form-group">
              <label class="form-label">Logo Aplikasi (untuk halaman login)</label>
              <div style="display:flex;align-items:center;gap:12px">
                <label class="btn btn-outline" style="cursor:pointer;margin:0;font-size:12px">
                   Pilih Logo
                  <input type="file" accept="image/*" style="display:none" onchange="handleAppLogoUpload(this)">
                </label>
                <img id="appLogoPreview" src="" style="height:48px;width:48px;border-radius:12px;object-fit:cover;border:1.5px solid var(--border);display:none">
                <span style="font-size:11px;color:var(--text-light)">PNG/JPG  tampil di halaman login & splash</span>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Nama Guru / Wali Kelas</label>
            <input type="text" id="setGuru" class="form-control" placeholder="Nama lengkap guru">
          </div>
          <div class="form-group">
            <label class="form-label">Kelas yang Diampu (Wali)</label>
            <input type="text" id="setWali" class="form-control" placeholder="Kelas 7A">
          </div>
          <div class="form-group">
            <label class="form-label">Tahun Pelajaran</label>
            <input type="text" id="setTP" class="form-control" placeholder="2025/2026">
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:20px">
        <div class="card-header"><span class="card-title"> Preview Kop Surat</span></div>
        <div class="kop-preview" id="kopPreview">
          <div class="kop-preview-inner">
            <img id="kopLogoImg" src="" class="kop-logo" style="display:none">
            <div id="kopLogoPlaceholder" style="width:60px;height:60px;background:var(--primary-light);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:28px"></div>
            <div class="kop-text">
              <h3 id="kopSchoolName">Nama Sekolah</h3>
              <p id="kopSubtitle">Subtitle sekolah</p>
              <p id="kopAddress" style="font-size:10px;margin-top:2px">Alamat sekolah</p>
            </div>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:20px">
        <div class="card-header"><span class="card-title"> Manajemen Kelas</span></div>
        <div style="display:flex;gap:10px;margin-bottom:14px">
          <input type="text" id="newKelas" class="form-control" style="width:200px" placeholder="Nama kelas baru...">
          <button class="btn btn-primary" onclick="addKelas()">+ Tambah</button>
        </div>
        <div id="kelasList" class="table-wrap">
          <table><thead><tr><th>Nama Kelas</th><th>Aksi</th></tr></thead>
          <tbody id="kelasTbody"></tbody></table>
        </div>
      </div>

      <div class="card" style="margin-top:20px">
        <div class="card-header"><span class="card-title"> Manajemen Mata Pelajaran</span></div>
        <div style="display:flex;gap:10px;margin-bottom:14px">
          <input type="text" id="newMapel" class="form-control" style="width:200px" placeholder="Nama mata pelajaran...">
          <button class="btn btn-primary" onclick="addMapel()">+ Tambah</button>
        </div>
        <div id="mapelList" class="table-wrap">
          <table><thead><tr><th>Mata Pelajaran</th><th>Aksi</th></tr></thead>
          <tbody id="mapelTbody"></tbody></table>
        </div>
      </div>

      <div class="card" style="margin-top:20px">
      <div class="card" style="margin-top:20px;display:none">
        
        <textarea class="form-control" rows="12" readonly id="sqlSetup" style="font-family:monospace;font-size:11px;background:#f8fafc"></textarea>
        <button class="btn btn-outline" style="margin-top:10px" onclick="copySql()"> Salin SQL</button>
      </div>
    </div>

  </div><!-- /content -->
</div><!-- /main -->

<!-- ===================== MODALS ===================== -->


    <!-- ===== TINGKATAN UMMI ===== -->
    <div id="page-ummiTingkatan" class="page">
      <div class="section-header">
        <div>
          <div class="section-title"> Tingkatan UMMI</div>
          <div class="section-sub">Kelola tingkatan Iqro dan Al-Quran untuk semua kelas (7, 8, 9)</div>
        </div>
      </div>

      <!-- UMMI 7 -->
      <div class="card" style="margin-bottom:18px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:22px"></span>
            <div>
              <div style="font-weight:800;font-size:15px;color:var(--text)">UMMI Kelas 7</div>
              <div style="font-size:11px;color:var(--text-light)">Tingkatan untuk siswa kelas 7</div>
            </div>
          </div>
          <button class="btn btn-primary" style="font-size:12px" onclick="showAddTingkatan('7')">+ Tambah Tingkatan</button>
        </div>
        <div id="tingkatanGrid7" style="display:flex;flex-direction:column;gap:10px">
          <span style="color:var(--text-light);font-size:13px">Memuat...</span>
        </div>
      </div>

      <!-- UMMI 8 -->
      <div class="card" style="margin-bottom:18px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:22px"></span>
            <div>
              <div style="font-weight:800;font-size:15px;color:var(--text)">UMMI Kelas 8</div>
              <div style="font-size:11px;color:var(--text-light)">Tingkatan untuk siswa kelas 8</div>
            </div>
          </div>
          <button class="btn btn-primary" style="font-size:12px" onclick="showAddTingkatan('8')">+ Tambah Tingkatan</button>
        </div>
        <div id="tingkatanGrid8" style="display:flex;flex-direction:column;gap:10px">
          <span style="color:var(--text-light);font-size:13px">Memuat...</span>
        </div>
      </div>

      <!-- UMMI 9 -->
      <div class="card" style="margin-bottom:18px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:22px"></span>
            <div>
              <div style="font-weight:800;font-size:15px;color:var(--text)">UMMI Kelas 9</div>
              <div style="font-size:11px;color:var(--text-light)">Tingkatan untuk siswa kelas 9</div>
            </div>
          </div>
          <button class="btn btn-primary" style="font-size:12px" onclick="showAddTingkatan('9')">+ Tambah Tingkatan</button>
        </div>
        <div id="tingkatanGrid9" style="display:flex;flex-direction:column;gap:10px">
          <span style="color:var(--text-light);font-size:13px">Memuat...</span>
        </div>
      </div>

      <!-- Info box -->
      <div style="background:var(--primary-light);border-radius:12px;padding:16px 18px;font-size:12px;color:var(--primary);border:1px solid #bfdbfe">
         <strong>Tips:</strong> Tingkatan yang dibuat di sini otomatis tersedia di <strong>semua form input pembayaran</strong> (kelas 7, 8, dan 9). Gunakan tombol "+ Tambah Iqro 16 & Al-Quran Sekaligus" untuk mengisi cepat.
      </div>
    </div>

    <!-- ===== UMMI 7 ===== -->
    <div id="page-ummi7" class="page">
      <div id="ummi7-content"></div>
    </div>
    <!-- ===== UMMI 8 ===== -->
    <div id="page-ummi8" class="page">
      <div id="ummi8-content"></div>
    </div>
    <!-- ===== UMMI 9 ===== -->
    <div id="page-ummi9" class="page">
      <div id="ummi9-content"></div>
    </div>

    
<!-- Modal Tingkatan UMMI -->
<div class="modal-overlay" id="modalTingkatan">
  <div class="modal" style="max-width:460px">
    <div class="modal-header">
      <h3 id="modalTingkatanTitle">Tambah Tingkatan UMMI</h3>
      <button class="btn-close" onclick="closeModal('modalTingkatan')"></button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="tingkatanEditId">
      <input type="hidden" id="tingkatanLevel">

      <!-- Info siswa (hanya tampil saat tambah baru) -->
      <div id="tingkatanSiswaInfo" style="background:#f0fdf4;border:1px solid #bbf7d0;border-radius:10px;padding:12px 14px;margin-bottom:14px;display:none">
        <div style="font-size:11px;font-weight:700;color:#059669;margin-bottom:4px"> TINGKATAN UNTUK KELAS</div>
        <div id="tingkatanSiswaDetail" style="font-size:12px;color:#065f46"></div>
      </div>

      <!-- Tambah Semua Sekaligus -->
      <div id="tingkatanBulkSection" style="background:var(--primary-light);border:1px solid #bfdbfe;border-radius:12px;padding:14px;margin-bottom:14px">
        <div style="font-size:12px;font-weight:700;color:var(--primary);margin-bottom:8px"> Tambah Semua Sekaligus</div>
        <div style="font-size:12px;color:#1e40af;margin-bottom:10px">Tambahkan Iqro 16 dan Al-Quran langsung sekaligus:</div>
        <button type="button" class="btn btn-primary" style="width:100%;font-size:12px" onclick="tambahSemuaTingkatan()">
          + Tambah Iqro 16 &amp; Al-Quran Sekaligus
        </button>
      </div>

      <div style="text-align:center;font-size:11px;color:var(--text-light);margin-bottom:12px;font-weight:600"> atau tambah satu per satu </div>

      <!-- Pilih Cepat (diisi oleh JS) -->
      <div class="form-group">
        <label class="form-label">Pilih Cepat Nama Tingkatan</label>
        <div id="tingkatanQuickBtns" style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:6px"></div>
        <div style="font-size:11px;color:var(--text-light)"> Klik untuk mengisi otomatis. Bisa ubah nama sebelum simpan.</div>
      </div>

      <div class="form-group">
        <label class="form-label">Nama Tingkatan</label>
        <input type="text" id="tingkatanNama" class="form-control" placeholder="cth: Iqro 1, Iqro 2, Al-Quran, atau tingkatan lain...">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Urutan</label>
          <input type="number" id="tingkatanUrutan" class="form-control" min="1" value="1">
        </div>
        <div class="form-group">
          <label class="form-label">Warna Label</label>
          <input type="color" id="tingkatanWarna" class="form-control" value="#1a56db" style="height:42px;cursor:pointer">
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('modalTingkatan')">Batal</button>
      <button class="btn btn-primary" onclick="saveTingkatan()">Simpan</button>
    </div>
  </div>
</div>

<!-- Modal Pembayaran UMMI -->
    <div class="modal-overlay" id="modalUmmi">
      <div class="modal" style="max-width:520px">
        <div class="modal-header">
          <h3 id="modalUmmiTitle">Input Pembayaran UMMI</h3>
          <button class="btn-close" onclick="closeModal('modalUmmi')"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="ummiEditId">
          <input type="hidden" id="ummiLevel">
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Nama Siswa</label>
              <select id="ummiSiswa" class="form-control"></select>
            </div>
            <div class="form-group">
              <label class="form-label">Tanggal Bayar</label>
              <input type="date" id="ummiTgl" class="form-control">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Semester</label>
              <select id="ummiSemester" class="form-control">
                <option value="Ganjil">Ganjil</option>
                <option value="Genap">Genap</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Tahun Pelajaran</label>
              <input type="text" id="ummiTP" class="form-control" placeholder="2025/2026">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Bulan</label>
              <select id="ummiBulan" class="form-control">
                <option>Juli</option><option>Agustus</option><option>September</option>
                <option>Oktober</option><option>November</option><option>Desember</option>
                <option>Januari</option><option>Februari</option><option>Maret</option>
                <option>April</option><option>Mei</option><option>Juni</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Status</label>
              <select id="ummiStatus" class="form-control">
                <option value="Lunas">Lunas</option>
                <option value="Belum Lunas">Belum Lunas</option>
                <option value="Cicilan">Cicilan</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Tingkatan UMMI</label>
            <select id="ummiTingkatanId" class="form-control">
              <option value="">-- Pilih Tingkatan --</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Nominal (Rp)</label>
            <input type="number" id="ummiNominal" class="form-control" placeholder="0" step="1000">
          </div>
          <div class="form-group">
            <label class="form-label">Catatan</label>
            <input type="text" id="ummiCatatan" class="form-control" placeholder="Keterangan tambahan...">
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-outline" onclick="closeModal('modalUmmi')">Batal</button>
          <button class="btn btn-primary" onclick="saveUmmi()">Simpan</button>
        </div>
      </div>
    </div>

<!-- Modal Tambah Siswa -->
<div class="modal-overlay" id="modalSiswa">
  <div class="modal">
    <div class="modal-header">
      <h3 id="modalSiswaTitle">Tambah Siswa Baru</h3>
      <button class="btn-close" onclick="closeModal('modalSiswa')"></button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="editSiswaId">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">NISN</label>
          <input type="text" id="siswaIns" class="form-control" placeholder="Nomor Induk Siswa Nasional">
        </div>
        <div class="form-group">
          <label class="form-label">Kelas</label>
          <select id="siswaKelas" class="form-control"></select>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Nama Lengkap</label>
        <input type="text" id="siswaNama" class="form-control" placeholder="Nama lengkap siswa">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Jenis Kelamin</label>
          <select id="siswaJK" class="form-control">
            <option>Laki-laki</option><option>Perempuan</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Bimbingan Wali</label>
          <select id="siswaBimbingan" class="form-control">
            <option value="0">Tidak</option><option value="1">Ya</option>
          </select>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('modalSiswa')">Batal</button>
      <button class="btn btn-primary" onclick="saveSiswa()">Simpan</button>
    </div>
  </div>
</div>

<!-- Modal Tambah Jadwal -->
<div class="modal-overlay" id="modalJadwal">
  <div class="modal">
    <div class="modal-header">
      <h3>Tambah Jadwal Mengajar</h3>
      <button class="btn-close" onclick="closeModal('modalJadwal')"></button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="editJadwalId">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Hari</label>
          <select id="jadwalHari" class="form-control">
            <option>Senin</option><option>Selasa</option><option>Rabu</option><option>Kamis</option><option>Jumat</option><option>Sabtu</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Kelas</label>
          <select id="jadwalKelas" class="form-control"></select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Jam Mulai</label>
          <input type="time" id="jadwalMulai" class="form-control">
        </div>
        <div class="form-group">
          <label class="form-label">Jam Selesai</label>
          <input type="time" id="jadwalSelesai" class="form-control">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Mata Pelajaran</label>
          <select id="jadwalMapel" class="form-control"></select>
        </div>
        <div class="form-group">
          <label class="form-label">Ruang</label>
          <input type="text" id="jadwalRuang" class="form-control" placeholder="Ruang kelas">
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('modalJadwal')">Batal</button>
      <button class="btn btn-primary" onclick="saveJadwal()">Simpan</button>
    </div>
  </div>
</div>

<!-- Modal Tambah Jurnal -->
<div class="modal-overlay" id="modalJurnal">
  <div class="modal">
    <div class="modal-header">
      <h3>Tambah Jurnal Mengajar</h3>
      <button class="btn-close" onclick="closeModal('modalJurnal')"></button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="editJurnalId">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Tanggal</label>
          <input type="date" id="jurnalTgl" class="form-control">
        </div>
        <div class="form-group">
          <label class="form-label">Kelas</label>
          <select id="jurnalKelas" class="form-control"></select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Mata Pelajaran</label>
          <select id="jurnalMapel" class="form-control"></select>
        </div>
        <div class="form-group">
          <label class="form-label">Pertemuan ke-</label>
          <input type="number" id="jurnalPertemuan" class="form-control" placeholder="1">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Materi / Topik</label>
        <input type="text" id="jurnalMateri" class="form-control" placeholder="Judul materi yang diajarkan">
      </div>
      <div class="form-group">
        <label class="form-label">Deskripsi Kegiatan</label>
        <textarea id="jurnalDesc" class="form-control" placeholder="Uraian kegiatan pembelajaran..."></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">Catatan / Evaluasi</label>
        <textarea id="jurnalCatatan" class="form-control" placeholder="Catatan, refleksi, atau evaluasi..."></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('modalJurnal')">Batal</button>
      <button class="btn btn-primary" onclick="saveJurnal()">Simpan</button>
    </div>
  </div>
</div>

<!-- Modal Bimbingan -->
<div class="modal-overlay" id="modalBimbingan">
  <div class="modal">
    <div class="modal-header">
      <h3>Pencatatan Bimbingan Wali</h3>
      <button class="btn-close" onclick="closeModal('modalBimbingan')"></button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="editBimbinganId">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Nama Murid</label>
          <select id="bimbinganSiswa" class="form-control"></select>
        </div>
        <div class="form-group">
          <label class="form-label">Tanggal</label>
          <input type="date" id="bimbinganTgl" class="form-control">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Kategori</label>
        <select id="bimbinganKat" class="form-control">
          <option>Akademik</option><option>Sosial</option><option>Pribadi</option><option>Karir</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Hasil Konseling / Masalah</label>
        <textarea id="bimbinganMasalah" class="form-control" placeholder="Uraikan masalah atau hasil konseling..."></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">Tindak Lanjut / Solusi</label>
        <textarea id="bimbinganSolusi" class="form-control" placeholder="Tindak lanjut yang akan dilakukan..."></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('modalBimbingan')">Batal</button>
      <button class="btn btn-primary" onclick="saveBimbingan()">Simpan Rekaman</button>
    </div>
  </div>
</div>

<!-- Modal Integrasi -->
<div class="modal-overlay" id="modalIntegrasi">
  <div class="modal">
    <div class="modal-header">
      <h3>Tambah Link ASN</h3>
      <button class="btn-close" onclick="closeModal('modalIntegrasi')"></button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="integrasiEditId">
      <input type="hidden" id="integrasiLogoB64">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Nama Layanan</label>
          <input type="text" id="integrasiNama" class="form-control" placeholder="cth: MyASN, e-Kinerja">
        </div>
        <div class="form-group">
          <label class="form-label">Ikon (Emoji)</label>
          <input type="text" id="integrasiIkon" class="form-control" placeholder="">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">URL / Link</label>
        <input type="url" id="integrasiUrl" class="form-control" placeholder="https://myasn.bkn.go.id">
      </div>
      <div class="form-group">
        <label class="form-label">Deskripsi Singkat</label>
        <input type="text" id="integrasiDesc" class="form-control" placeholder="Deskripsi layanan...">
      </div>
      <div class="form-group">
        <label class="form-label">Logo / Gambar (Opsional)</label>
        <div style="display:flex;align-items:center;gap:14px">
          <label class="btn btn-outline" style="cursor:pointer;margin:0;font-size:12px">
             Pilih Gambar
            <input type="file" accept="image/*" style="display:none" onchange="handleIntegLogoUpload(this)">
          </label>
          <img id="integrasiLogoPreview" src="" alt="preview" style="height:44px;width:44px;border-radius:10px;object-fit:cover;border:1.5px solid var(--border);display:none">
          <span style="font-size:11px;color:var(--text-light)">PNG/JPG, akan menggantikan emoji</span>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('modalIntegrasi')">Batal</button>
      <button class="btn btn-primary" onclick="saveIntegrasi()">Simpan</button>
    </div>
  </div>
</div>

<!-- Modal Integrasi Kinerja -->
<div class="modal-overlay" id="modalKinerja">
  <div class="modal">
    <div class="modal-header">
      <h3 id="modalKinerjaTitle">Tambah Link Kinerja</h3>
      <button class="btn-close" onclick="closeModal('modalKinerja')"></button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="kinerjaEditId">
      <input type="hidden" id="kinerjaLogoB64">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Nama Layanan</label>
          <input type="text" id="kinerjaNama" class="form-control" placeholder="cth: e-Kinerja, PMM, SIMPATIKA">
        </div>
        <div class="form-group">
          <label class="form-label">Ikon (Emoji)</label>
          <input type="text" id="kinerjaIkon" class="form-control" placeholder="">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">URL / Link</label>
        <input type="url" id="kinerjaUrl" class="form-control" placeholder="https://kinerja.bkn.go.id">
      </div>
      <div class="form-group">
        <label class="form-label">Deskripsi Singkat</label>
        <input type="text" id="kinerjaDesc" class="form-control" placeholder="Deskripsi layanan...">
      </div>
      <div class="form-group">
        <label class="form-label">Logo / Gambar (Opsional)</label>
        <div style="display:flex;align-items:center;gap:14px">
          <label class="btn btn-outline" style="cursor:pointer;margin:0;font-size:12px">
             Pilih Gambar
            <input type="file" accept="image/*" style="display:none" onchange="handleKinerjaLogoUpload(this)">
          </label>
          <img id="kinerjaLogoPreview" src="" alt="preview" style="height:44px;width:44px;border-radius:10px;object-fit:cover;border:1.5px solid var(--border);display:none">
          <span style="font-size:11px;color:var(--text-light)">PNG/JPG, akan menggantikan emoji</span>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('modalKinerja')">Batal</button>
      <button class="btn btn-primary" onclick="saveKinerja()">Simpan</button>
    </div>
  </div>
</div>

<script>
// ================================================================
// APEL JUMBO  - Application Logic
// Created & Developed by D.D Candra
// ================================================================

let db = null;
let CONFIG = {};
let APP_DATA = { kelas: [], mapel: [], siswa: [], jadwal: [], integrasi: [], kinerja: [] };
let currentUser = null;
let editingId = null;

// ===================== INIT =====================
window.addEventListener('DOMContentLoaded', async () => {
  loadConfig();
  setDefaultDates();
  populateBulan();
  setSqlSetup();
  
  initSupabase();

  if (!CONFIG.supaUrl || !CONFIG.supaKey) {
    document.getElementById('loginPage').classList.add('hide');
    document.getElementById('setupPage').classList.remove('hide');
    return;
  }

  // Cara paling reliable: langsung tanya Supabase apakah ada session aktif.
  // Ini bekerja di SEMUA device karena Supabase menyimpan token-nya sendiri.
  try {
    const { data: { session }, error } = await db.auth.getSession();
    if (session && session.user) {
      currentUser = session.user;
      // Perbarui localStorage dengan session terbaru
      localStorage.setItem('apel_session', JSON.stringify(session));
      await afterLogin();
      return;
    }
  } catch(e) {
    console.warn('getSession error:', e);
  }

  // Fallback: coba pulihkan dari localStorage (untuk browser yang cache token)
  const saved = localStorage.getItem('apel_session');
  if (saved) {
    try {
      const s = JSON.parse(saved);
      const { data, error } = await db.auth.setSession(s);
      if (!error && data && data.user) {
        currentUser = data.user;
        await afterLogin();
        return;
      }
    } catch(e) {
      console.warn('setSession error:', e);
    }
  }

  // Tidak ada session valid  tampilkan halaman login
  localStorage.removeItem('apel_session');
  document.getElementById('loginPage').classList.remove('hide');
});

function loadConfig() {
  const cfg = localStorage.getItem('apel_config');
  if (cfg) CONFIG = JSON.parse(cfg);
  // Default Supabase credentials (pre-configured)
  if (!CONFIG.supaUrl) CONFIG.supaUrl = 'https://owejzwznmmyqxkefgbtv.supabase.co';
  if (!CONFIG.supaKey) CONFIG.supaKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im93ZWp6d3pubW15cXhrZWZnYnR2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1NDk5NjYsImV4cCI6MjA4NzEyNTk2Nn0.7WjNsY55AepK2ci9CpGO2G-YyG58YVi-IKrc1BQDu2A';
  applyConfig();
}

function applyConfig() {
  document.getElementById('sidebarSchoolName').textContent = CONFIG.school || 'Nama Sekolah';
  document.getElementById('sidebarSchoolSub').textContent = CONFIG.subtitle || '-';
  if (CONFIG.logo) {
    const sbl = document.getElementById('sidebarLogo');
    sbl.innerHTML = `<img src="${CONFIG.logo}" alt="logo">`;
  }
  // pengaturan page
  if (document.getElementById('setSchool')) {
    document.getElementById('setSchool').value = CONFIG.school || '';
    document.getElementById('setSubtitle').value = CONFIG.subtitle || '';
    document.getElementById('setNpsn').value = CONFIG.npsn || '';
    document.getElementById('setAddress').value = CONFIG.address || '';
    document.getElementById('setPhone').value = CONFIG.phone || '';
    document.getElementById('setSupaUrl').value = CONFIG.supaUrl || '';
    document.getElementById('setSupaKey').value = CONFIG.supaKey || '';
    document.getElementById('setGuru').value = CONFIG.guru || '';
    document.getElementById('setWali').value = CONFIG.wali || '';
    const setTP = document.getElementById('setTP');
    if (setTP) setTP.value = CONFIG.tahunPelajaran || '';
    const setAppName = document.getElementById('setAppName');
    if (setAppName) setAppName.value = CONFIG.appName || '';
    const setAppSub = document.getElementById('setAppSubtitle');
    if (setAppSub) setAppSub.value = CONFIG.appSubtitle || '';
    // Show logo preview if exists
    if (CONFIG.appLogo) {
      const prev = document.getElementById('appLogoPreview');
      if (prev) { prev.src = CONFIG.appLogo; prev.style.display = 'block'; }
    }
    if (CONFIG.logo) {
      const img = document.getElementById('setLogoPreview');
      img.src = CONFIG.logo; img.style.display = 'block';
      document.getElementById('kopLogoImg').src = CONFIG.logo;
      document.getElementById('kopLogoImg').style.display = 'block';
      document.getElementById('kopLogoPlaceholder').style.display = 'none';
    }
    document.getElementById('kopSchoolName').textContent = CONFIG.school || 'Nama Sekolah';
    document.getElementById('kopSubtitle').textContent = CONFIG.subtitle || '';
    document.getElementById('kopAddress').textContent = CONFIG.address || '';
  }
}

function initSupabase() {
  if (!CONFIG.supaUrl || !CONFIG.supaKey) return;
  const { createClient } = window.supabase;
  db = createClient(CONFIG.supaUrl, CONFIG.supaKey);
}

// ===================== AUTH =====================
async function doLogin() {
  const email = document.getElementById('loginEmail').value;
  const pass = document.getElementById('loginPass').value;
  if (!email || !pass) return toast('Isi email dan password', 'error');
  if (!db) { initSupabase(); }
  if (!db) return toast('Konfigurasi Supabase dulu!', 'error');
  
  document.getElementById('loginBtnText').innerHTML = '<span class="loading"></span>';
  try {
    const { data, error } = await db.auth.signInWithPassword({ email, password: pass });
    if (error) throw error;
    currentUser = data.user;
    localStorage.setItem('apel_session', JSON.stringify(data.session));
    await afterLogin();
  } catch(e) {
    toast(e.message || 'Login gagal', 'error');
  }
  document.getElementById('loginBtnText').textContent = 'Masuk';
}

async function doRegister() {
  const email = document.getElementById('loginEmail').value;
  const pass = document.getElementById('loginPass').value;
  if (!email || !pass) return toast('Isi email dan password', 'error');
  if (!db) initSupabase();
  if (!db) return toast('Konfigurasi Supabase dulu!', 'error');
  try {
    const { error } = await db.auth.signUp({ email, password: pass });
    if (error) throw error;
    toast('Pendaftaran berhasil! Cek email untuk verifikasi.', 'success');
  } catch(e) { toast(e.message || 'Gagal daftar', 'error'); }
}

async function doLogout() {
  localStorage.removeItem('apel_session');
  localStorage.removeItem('apel_last_page');
  if (db) await db.auth.signOut();
  location.reload();
}

async function afterLogin() {
  document.getElementById('loginPage').classList.add('hide');
  document.getElementById('setupPage').classList.add('hide');
  document.getElementById('guruTopbar').textContent = CONFIG.guru || '';
  document.getElementById('dashDate').textContent = new Date().toLocaleDateString('id-ID', {weekday:'long',year:'numeric',month:'long',day:'numeric'});
  await loadAllData();
  const lastPage = localStorage.getItem('apel_last_page') || 'dashboard';
  showPage(lastPage);
}

// ===================== SETUP / CONFIG =====================
function showSetupFromLogin() {
  document.getElementById('loginPage').classList.add('hide');
  document.getElementById('setupPage').classList.remove('hide');
  // pre-fill
  document.getElementById('cfgUrl').value = CONFIG.supaUrl || '';
  document.getElementById('cfgKey').value = CONFIG.supaKey || '';
  document.getElementById('cfgSchool').value = CONFIG.school || '';
  document.getElementById('cfgNpsn').value = CONFIG.npsn || '';
  document.getElementById('cfgAddress').value = CONFIG.address || '';
  document.getElementById('cfgPhone').value = CONFIG.phone || '';
  document.getElementById('cfgSubtitle').value = CONFIG.subtitle || '';
}

function goBackLogin() {
  document.getElementById('setupPage').classList.add('hide');
  document.getElementById('loginPage').classList.remove('hide');
}

function previewLogo(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = (e) => {
    document.getElementById('logoPreview').src = e.target.result;
    document.getElementById('logoPreviewWrap').style.display = 'block';
    CONFIG._pendingLogo = e.target.result;
  };
  reader.readAsDataURL(file);
}

function updateLogoPreview(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = (e) => {
    const img = document.getElementById('setLogoPreview');
    img.src = e.target.result; img.style.display = 'block';
    document.getElementById('kopLogoImg').src = e.target.result;
    document.getElementById('kopLogoImg').style.display = 'block';
    document.getElementById('kopLogoPlaceholder').style.display = 'none';
    CONFIG._pendingLogo = e.target.result;
  };
  reader.readAsDataURL(file);
}

function saveConfig() {
  CONFIG.supaUrl = document.getElementById('cfgUrl').value.trim();
  CONFIG.supaKey = document.getElementById('cfgKey').value.trim();
  CONFIG.school = document.getElementById('cfgSchool').value.trim();
  CONFIG.npsn = document.getElementById('cfgNpsn').value.trim();
  CONFIG.address = document.getElementById('cfgAddress').value.trim();
  CONFIG.phone = document.getElementById('cfgPhone').value.trim();
  CONFIG.subtitle = document.getElementById('cfgSubtitle').value.trim();
  if (CONFIG._pendingLogo) { CONFIG.logo = CONFIG._pendingLogo; delete CONFIG._pendingLogo; }
  localStorage.setItem('apel_config', JSON.stringify(CONFIG));
  initSupabase();
  toast('Konfigurasi disimpan!', 'success');
  document.getElementById('setupPage').classList.add('hide');
  document.getElementById('loginPage').classList.remove('hide');
}

function savePengaturan() {
  CONFIG.school = document.getElementById('setSchool').value.trim();
  CONFIG.subtitle = document.getElementById('setSubtitle').value.trim();
  CONFIG.npsn = document.getElementById('setNpsn').value.trim();
  CONFIG.address = document.getElementById('setAddress').value.trim();
  CONFIG.phone = document.getElementById('setPhone').value.trim();
  CONFIG.supaUrl = document.getElementById('setSupaUrl').value.trim();
  CONFIG.supaKey = document.getElementById('setSupaKey').value.trim();
  CONFIG.guru = document.getElementById('setGuru').value.trim();
  CONFIG.wali = document.getElementById('setWali').value.trim();
  CONFIG.tahunPelajaran = document.getElementById('setTP').value.trim();
  CONFIG.appName = document.getElementById('setAppName')?.value.trim() || CONFIG.appName;
  CONFIG.appSubtitle = document.getElementById('setAppSubtitle')?.value.trim() || CONFIG.appSubtitle;
  if (CONFIG._pendingLogo) { CONFIG.logo = CONFIG._pendingLogo; delete CONFIG._pendingLogo; }
  localStorage.setItem('apel_config', JSON.stringify(CONFIG));
  initSupabase();
  applyConfig();
  const gt = document.getElementById('guruTopbar');
  if (gt) gt.textContent = CONFIG.guru || '';
  toast('Pengaturan berhasil disimpan!', 'success');
}

// ===================== LOAD DATA =====================
async function loadAllData() {
  await Promise.all([loadKelas(), loadMapel(), loadSiswaAll(), loadJadwalAll(), loadIntegrasi(), loadTingkatanAll(), loadKinerja()]);
  populateAllSelects();
  loadDashboard();
  // Load mapping siswa per tingkatan setelah data siswa siap
  loadSiswaPerTingkatan();
}

async function loadKelas() {
  if (!db) return;
  const { data } = await db.from('kelas').select('*').order('nama');
  APP_DATA.kelas = data || [];
  renderKelasTbody();
}

async function loadMapel() {
  if (!db) return;
  const { data } = await db.from('mapel').select('*').order('nama');
  APP_DATA.mapel = data || [];
  renderMapelTbody();
}

async function loadSiswaAll() {
  if (!db) return;
  const { data } = await db.from('siswa').select('*').order('nama');
  APP_DATA.siswa = data || [];
}

async function loadJadwalAll() {
  if (!db) return;
  const hariOrder = ['Senin','Selasa','Rabu','Kamis','Jumat','Sabtu'];
  const { data } = await db.from('jadwal').select('*');
  APP_DATA.jadwal = (data || []).sort((a,b) => hariOrder.indexOf(a.hari) - hariOrder.indexOf(b.hari) || a.jam_mulai.localeCompare(b.jam_mulai));
}

async function loadIntegrasi() {
  if (!db) return;
  const { data } = await db.from('integrasi').select('*').order('nama');
  APP_DATA.integrasi = data || [];
  renderIntegrasi();
}

function populateAllSelects() {
  const kelasSels = ['filterKelasS','absenKelas','rekapAbsenKelas','nilaiKelas','rekapNilaiKelas','filterJurnalKelas','jadwalKelas','siswaKelas','jurnalKelas','filterBimbinganSiswa','filterJadwalKelas'];
  // Populate kelas selects
  ['filterKelasS','absenKelas','rekapAbsenKelas','nilaiKelas','rekapNilaiKelas','filterJurnalKelas','jadwalKelas','siswaKelas','jurnalKelas'].forEach(id => {
    const el = document.getElementById(id);
    if (!el) return;
    const hasAll = ['filterKelasS','rekapAbsenKelas','filterJurnalKelas'].includes(id);
    const savedVal = el.value; // Save current value BEFORE repopulating
    el.innerHTML = (hasAll ? '<option value="">Semua</option>' : '') + APP_DATA.kelas.map(k=>`<option value="${k.id}">${k.nama}</option>`).join('');
    // Restore saved value if it still exists in the new options
    if (savedVal && [...el.options].some(o => o.value === savedVal)) el.value = savedVal;
  });
  // Populate mapel selects
  ['jadwalMapel','jurnalMapel','rekapNilaiMapel'].forEach(id => {
    const el = document.getElementById(id);
    if (!el) return;
    el.innerHTML = APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('');
  });
  // Bimbingan siswa filter
  const bimbSiswa = document.getElementById('filterBimbinganSiswa');
  if (bimbSiswa) bimbSiswa.innerHTML = '<option value="">Semua Siswa</option>' + APP_DATA.siswa.map(s=>`<option value="${s.id}">${s.nama} (${getKelasName(s.kelas_id)})</option>`).join('');
  const bimbSiswa2 = document.getElementById('bimbinganSiswa');
  if (bimbSiswa2) bimbSiswa2.innerHTML = APP_DATA.siswa.map(s=>`<option value="${s.id}">${s.nama} (${getKelasName(s.kelas_id)})</option>`).join('');
  
  updateNilaiMapel();
  updateRekapMapel();
  loadSiswa();
  loadJadwal();
  loadJurnal();
  loadBimbingan();
  loadSiswaAbsen();
  loadRekapAbsen();
  loadRekapNilai();
}

function getKelasName(id) { return (APP_DATA.kelas.find(k=>k.id==id)||{}).nama || '-'; }
function getMapelName(id) { return (APP_DATA.mapel.find(m=>m.id==id)||{}).nama || '-'; }
function getSiswaName(id) { return (APP_DATA.siswa.find(s=>s.id==id)||{}).nama || '-'; }

// ===================== DASHBOARD =====================
async function loadDashboard() {
  // Show guru info card
  const guruNama = CONFIG.guru || '';
  const guruWali = CONFIG.wali || '';
  const tp = CONFIG.tahunPelajaran || '';
  if (guruNama) {
    document.getElementById('guruInfoCard').style.display = 'block';
    document.getElementById('dashGuruNama').textContent = guruNama;
    document.getElementById('dashGuruWali').textContent = guruWali ? `Wali Kelas: ${guruWali}` : 'Guru Mata Pelajaran';
    document.getElementById('dashTP').textContent = tp || `${new Date().getFullYear()}/${new Date().getFullYear()+1}`;
    document.getElementById('guruAvatar').textContent = guruNama.charAt(0).toUpperCase();
    const jam = new Date().getHours();
    const sapa = jam < 11 ? 'Selamat Pagi' : jam < 15 ? 'Selamat Siang' : jam < 18 ? 'Selamat Sore' : 'Selamat Malam';
    document.getElementById('dashGreeting').textContent = `${sapa}, ${guruNama.split(' ')[0]}! `;
  }
  const cards = [
    { label: 'Total Siswa', val: APP_DATA.siswa.length, icon: '', color: '#ebf5ff', iconColor: '#1a56db' },
    { label: 'Siswa Bimbingan', val: APP_DATA.siswa.filter(s=>s.bimbingan==1).length, icon: '', color: '#fce7f3', iconColor: '#db2777' },
    { label: 'Jumlah Kelas', val: APP_DATA.kelas.length, icon: '', color: '#d1fae5', iconColor: '#065f46' },
    { label: 'Mata Pelajaran', val: APP_DATA.mapel.length, icon: '', color: '#fef3c7', iconColor: '#92400e' },
  ];
  document.getElementById('statCards').innerHTML = cards.map(c=>`
    <div class="stat-card">
      <div class="stat-icon" style="background:${c.color}"><span style="font-size:22px">${c.icon}</span></div>
      <div class="stat-info">
        <h3 style="color:${c.iconColor}">${c.val}</h3>
        <p>${c.label}</p>
      </div>
    </div>
  `).join('');
  
  // Jadwal hari ini
  const hariNow = ['Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu'][new Date().getDay()];
  const todayJadwal = APP_DATA.jadwal.filter(j=>j.hari===hariNow);
  document.getElementById('jadwalToday').innerHTML = todayJadwal.length ? todayJadwal.map(j=>`
    <div style="display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--border)">
      <div style="background:var(--primary-light);color:var(--primary);border-radius:8px;padding:6px 10px;font-size:11px;font-weight:700;white-space:nowrap">${j.jam_mulai||''} - ${j.jam_selesai||''}</div>
      <div><div style="font-size:13px;font-weight:700">${getMapelName(j.mapel_id)}</div><div style="font-size:11px;color:var(--text-light)">${getKelasName(j.kelas_id)}  ${j.ruang||''}</div></div>
    </div>
  `).join('') : '<div class="empty-state" style="padding:30px"><div class="empty-icon"></div><p>Tidak ada jadwal hari ini</p></div>';
  
  // Jurnal terbaru
  const { data: jurnals } = await db.from('jurnal').select('*').order('tanggal',{ascending:false}).limit(3);
  document.getElementById('jurnalRecent').innerHTML = (jurnals||[]).length ? (jurnals||[]).map(j=>`
    <div class="jurnal-card">
      <div class="jurnal-meta">${j.tanggal}  ${getKelasName(j.kelas_id)}  ${getMapelName(j.mapel_id)}</div>
      <div class="jurnal-content" style="font-weight:700">${j.materi||''}</div>
    </div>
  `).join('') : '<div class="empty-state" style="padding:30px"><div class="empty-icon"></div><p>Belum ada jurnal</p></div>';
}

// ===================== SISWA =====================
function loadSiswa() {
  const kelasFilter = document.getElementById('filterKelasS')?.value;
  // Filter locally from APP_DATA (preserves filter state after edits)
  let filtered = kelasFilter 
    ? APP_DATA.siswa.filter(s => String(s.kelas_id) === String(kelasFilter))
    : APP_DATA.siswa;
  document.getElementById('siswaTbody').innerHTML = filtered.length ? filtered.map(s=>`
    <tr>
      <td><span class="badge badge-gray">${s.nis||'-'}</span></td>
      <td><strong>${s.nama}</strong></td>
      <td>${getKelasName(s.kelas_id)}</td>
      <td>${s.jenis_kelamin||'-'}</td>
      <td>${s.bimbingan==1?'<span class="badge badge-primary"> Ya</span>':'<span class="badge badge-gray">Tidak</span>'}</td>
      <td><button class="btn btn-sm btn-outline" onclick="editSiswa(${s.id})"></button> <button class="btn btn-sm btn-danger" onclick="deleteSiswa(${s.id})"></button></td>
    </tr>
  `).join('') : `<tr><td colspan="6" style="text-align:center;padding:30px;color:var(--text-light)">${kelasFilter ? 'Tidak ada siswa di kelas ini' : 'Belum ada data siswa'}</td></tr>`;
}

function showAddSiswa() {
  editingId = null;
  document.getElementById('editSiswaId').value = '';
  document.getElementById('siswaIns').value = '';
  document.getElementById('siswaNama').value = '';
  document.getElementById('siswaJK').value = 'Laki-laki';
  document.getElementById('siswaBimbingan').value = '0';
  // Always rebuild kelas dropdown with latest data
  const kelasOpts = APP_DATA.kelas.map(k=>`<option value="${k.id}">${k.nama}</option>`).join('');
  document.getElementById('siswaKelas').innerHTML = kelasOpts || '<option value="">-- Tambah kelas dulu di Pengaturan --</option>';
  document.getElementById('modalSiswaTitle').textContent = 'Tambah Siswa Baru';
  openModal('modalSiswa');
}

function editSiswa(id) {
  const s = APP_DATA.siswa.find(x=>x.id==id); if (!s) return;
  editingId = id;
  document.getElementById('editSiswaId').value = id;
  const kelasOpts = APP_DATA.kelas.map(k=>`<option value="${k.id}" ${k.id==s.kelas_id?'selected':''}>${k.nama}</option>`).join('');
  document.getElementById('siswaKelas').innerHTML = kelasOpts || '<option value="">-- Tambah kelas dulu di Pengaturan --</option>';
  document.getElementById('siswaIns').value = s.nis||'';
  document.getElementById('siswaNama').value = s.nama||'';
  document.getElementById('siswaJK').value = s.jenis_kelamin||'Laki-laki';
  document.getElementById('siswaBimbingan').value = s.bimbingan||'0';
  document.getElementById('modalSiswaTitle').textContent = 'Edit Data Siswa';
  openModal('modalSiswa');
}

async function saveSiswa() {
  const kelasId = document.getElementById('siswaKelas').value;
  if (!kelasId) return toast('Pilih kelas terlebih dahulu. Tambahkan kelas di menu Pengaturan jika belum ada.', 'error');
  const row = {
    nis: document.getElementById('siswaIns').value,
    nama: document.getElementById('siswaNama').value,
    kelas_id: kelasId,
    jenis_kelamin: document.getElementById('siswaJK').value,
    bimbingan: parseInt(document.getElementById('siswaBimbingan').value),
    user_id: currentUser.id
  };
  if (!row.nama) return toast('Nama harus diisi', 'error');
  let err;
  if (editingId) {
    const res = await db.from('siswa').update(row).eq('id', editingId);
    err = res.error;
  } else {
    const res = await db.from('siswa').insert(row);
    err = res.error;
  }
  if (err) return toast(err.message, 'error');
  toast('Data siswa disimpan!', 'success');
  closeModal('modalSiswa');
  // Capture current filter BEFORE reload
  const _kelasFilter = document.getElementById('filterKelasS')?.value || '';
  await loadSiswaAll();
  await populateAllSelects(); // restores dropdown values automatically
  // Force restore filter if somehow lost
  const _fe = document.getElementById('filterKelasS');
  if (_fe && _kelasFilter) _fe.value = _kelasFilter;
  loadSiswa();
}

async function deleteSiswa(id) {
  if (!confirm('Hapus siswa ini?')) return;
  const { error } = await db.from('siswa').delete().eq('id', id);
  if (error) return toast(error.message, 'error');
  toast('Siswa dihapus', 'success');
  const _cf = document.getElementById('filterKelasS')?.value||'';
  await loadSiswaAll();
  await populateAllSelects();
  const _fe2 = document.getElementById('filterKelasS');
  if (_fe2 && _cf) _fe2.value = _cf;
  loadSiswa();
}

// ===================== JADWAL =====================
async function loadJadwal() {
  await loadJadwalAll();
  // Populate jadwal filter dropdowns
  const fKelas = document.getElementById('filterJadwalKelas');
  const fMapel = document.getElementById('filterJadwalMapel');
  if (fKelas) {
    fKelas.innerHTML = '<option value="">Semua Kelas</option>' +
      APP_DATA.kelas.map(k=>`<option value="${k.id}">${k.nama}</option>`).join('');
  }
  if (fMapel) {
    fMapel.innerHTML = '<option value="">Semua Mapel</option>' +
      APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('');
  }
  renderJadwal();
}

function renderJadwal() {
  const kelasFilter = document.getElementById('filterJadwalKelas')?.value;
  const mapelFilter = document.getElementById('filterJadwalMapel')?.value;
  const hariFilter = document.getElementById('filterJadwalHari')?.value;
  
  const hariOrder = ['Senin','Selasa','Rabu','Kamis','Jumat','Sabtu'];
  let filtered = APP_DATA.jadwal.filter(j => {
    if (kelasFilter && String(j.kelas_id) !== String(kelasFilter)) return false;
    if (mapelFilter && String(j.mapel_id) !== String(mapelFilter)) return false;
    if (hariFilter && j.hari !== hariFilter) return false;
    return true;
  }).sort((a,b) => (hariOrder.indexOf(a.hari)-hariOrder.indexOf(b.hari)) || a.jam_mulai?.localeCompare(b.jam_mulai||''));
  
  document.getElementById('jadwalTbody').innerHTML = filtered.length ? filtered.map(j=>`
    <tr>
      <td><span class="badge badge-primary">${j.hari}</span></td>
      <td>${j.jam_mulai||''}  ${j.jam_selesai||''}</td>
      <td>${getKelasName(j.kelas_id)}</td>
      <td><strong>${getMapelName(j.mapel_id)}</strong></td>
      <td>${j.ruang||'-'}</td>
      <td><button class="btn btn-sm btn-danger" onclick="deleteJadwal(${j.id})"></button></td>
    </tr>
  `).join('') : '<tr><td colspan="6" style="text-align:center;padding:30px;color:var(--text-light)">Tidak ada jadwal ditemukan</td></tr>';
}

function showAddJadwal() {
  document.getElementById('editJadwalId').value = '';
  document.getElementById('jadwalKelas').innerHTML = APP_DATA.kelas.map(k=>`<option value="${k.id}">${k.nama}</option>`).join('');
  document.getElementById('jadwalMapel').innerHTML = APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('');
  openModal('modalJadwal');
}

async function saveJadwal() {
  const row = {
    hari: document.getElementById('jadwalHari').value,
    kelas_id: document.getElementById('jadwalKelas').value,
    jam_mulai: document.getElementById('jadwalMulai').value,
    jam_selesai: document.getElementById('jadwalSelesai').value,
    mapel_id: document.getElementById('jadwalMapel').value,
    ruang: document.getElementById('jadwalRuang').value,
    user_id: currentUser.id
  };
  const { error } = await db.from('jadwal').insert(row);
  if (error) return toast(error.message, 'error');
  toast('Jadwal disimpan!', 'success');
  closeModal('modalJadwal');
  await loadJadwal();
  updateNilaiMapel(); updateRekapMapel();
}

async function deleteJadwal(id) {
  if (!confirm('Hapus jadwal ini?')) return;
  await db.from('jadwal').delete().eq('id', id);
  toast('Jadwal dihapus'); await loadJadwal();
}

// ===================== ABSENSI =====================
let absenData = {};

async function loadSiswaAbsen() {
  const kelasId = document.getElementById('absenKelas').value;
  const siswaKelas = APP_DATA.siswa.filter(s=>s.kelas_id==kelasId);
  absenData = {};
  siswaKelas.forEach(s=>{ absenData[s.id] = 'H'; });
  renderAbsenList(siswaKelas);
}

function renderAbsenList(siswaList) {
  document.getElementById('absenList').innerHTML = siswaList.map(s=>`
    <div class="absen-row">
      <span class="absen-name">${s.nama}</span>
      ${['H','S','I','A'].map(opt=>`
        <div class="absen-opt ${opt} ${absenData[s.id]===opt?'sel':''}" onclick="setAbsen(${s.id},'${opt}',this,'${siswaList.map(x=>x.id).join(',')}')">${opt}</div>
      `).join('')}
    </div>
  `).join('');
}

function setAbsen(siswaId, status, el, allIds) {
  absenData[siswaId] = status;
  const allIdArr = allIds.split(',');
  const siswaList = APP_DATA.siswa.filter(s=>allIdArr.includes(String(s.id)));
  // Re-render just this row
  const parent = el.closest('.absen-row');
  parent.querySelectorAll('.absen-opt').forEach(opt=>{
    opt.classList.toggle('sel', opt.classList.contains(status) && opt.textContent===status);
  });
  // Fix: re-set correct class
  parent.querySelectorAll('.absen-opt').forEach(opt=>{
    opt.classList.remove('sel');
    if(opt.textContent === status) opt.classList.add('sel');
  });
}

async function simpanAbsen() {
  const kelasId = document.getElementById('absenKelas').value;
  const tanggal = document.getElementById('absenDate').value;
  if (!tanggal) return toast('Pilih tanggal', 'error');
  const rows = Object.entries(absenData).map(([siswa_id, status])=>({
    siswa_id: parseInt(siswa_id), tanggal, status, kelas_id: parseInt(kelasId), user_id: currentUser.id
  }));
  if (!rows.length) return toast('Tidak ada siswa', 'error');
  // Upsert (delete then insert)
  await db.from('absensi').delete().eq('tanggal', tanggal).eq('kelas_id', kelasId);
  const { error } = await db.from('absensi').insert(rows);
  if (error) return toast(error.message, 'error');
  toast('Absensi disimpan!', 'success');
}

// ===================== REKAP ABSENSI =====================
async function loadRekapAbsen() {
  const kelasId = document.getElementById('rekapAbsenKelas')?.value;
  const mapelId = document.getElementById('rekapAbsenMapel')?.value;
  const bulan = document.getElementById('rekapAbsenBulan')?.value;
  
  // Populate mapel dropdown for rekap
  const rekapMapelEl = document.getElementById('rekapAbsenMapel');
  if (rekapMapelEl && rekapMapelEl.options.length <= 1) {
    rekapMapelEl.innerHTML = '<option value="">Semua Mapel</option>' +
      APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('');
  }
  if (!kelasId || !bulan) return;
  
  let query = db.from('absensi').select('*');
  if (kelasId) query = query.eq('kelas_id', kelasId);
  if (bulan) query = query.like('tanggal', `%-${bulan}-%`);
  
  const { data } = await query;
  const records = data || [];
  const siswaKelas = APP_DATA.siswa.filter(s=>!kelasId||s.kelas_id==kelasId);
  
  const tbody = document.getElementById('rekapAbsenTbody');
  tbody.innerHTML = siswaKelas.map(s=>{
    const rec = records.filter(r=>r.siswa_id==s.id);
    const H = rec.filter(r=>r.status==='H').length;
    const S = rec.filter(r=>r.status==='S').length;
    const I = rec.filter(r=>r.status==='I').length;
    const A = rec.filter(r=>r.status==='A').length;
    const total = rec.length;
    const pct = total ? Math.round(H/total*100) : 0;
    return `<tr>
      <td><strong>${s.nama}</strong></td>
      <td>${getKelasName(s.kelas_id)}</td>
      <td class="score-cell">${total}</td>
      <td class="score-cell score-high">${H}</td>
      <td class="score-cell score-mid">${S}</td>
      <td class="score-cell" style="color:var(--primary)">${I}</td>
      <td class="score-cell score-low">${A}</td>
      <td class="score-cell"><span class="badge ${pct>=80?'badge-success':pct>=60?'badge-warning':'badge-danger'}">${pct}%</span></td>
    </tr>`;
  }).join('');
}

// ===================== NILAI =====================
function updateNilaiMapel() {
  const el = document.getElementById('nilaiMapel');
  if (el) el.innerHTML = APP_DATA.mapel.length 
    ? APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('') 
    : '<option value="">-- tambah mapel di Pengaturan --</option>';
}

async function loadSiswaNilai() {
  const kelasId = document.getElementById('nilaiKelas').value;
  const mapelId = document.getElementById('nilaiMapel').value;
  const kategori = document.getElementById('nilaiKategori').value;
  const siswaKelas = APP_DATA.siswa.filter(s=>s.kelas_id==kelasId);
  
  // Load existing nilai
  const { data: existing } = await db.from('nilai').select('*')
    .eq('kelas_id', kelasId).eq('mapel_id', mapelId).eq('kategori', kategori);
  const nilaiMap = {};
  (existing||[]).forEach(n=>{ nilaiMap[n.siswa_id] = n.skor; });
  
  document.getElementById('nilaiFormContainer').innerHTML = `
    <div style="margin-bottom:12px">
      <div style="display:grid;grid-template-columns:1fr 100px;gap:10px;padding:8px 0;border-bottom:2px solid var(--border)">
        <span style="font-size:11px;font-weight:700;color:var(--text-light)">NAMA MURID</span>
        <span style="text-align:center;font-size:11px;font-weight:700;color:var(--text-light)">SKOR NILAI</span>
      </div>
      ${siswaKelas.map(s=>`
        <div class="nilai-row">
          <span class="nilai-name">${s.nama}</span>
          <input type="number" class="nilai-input" id="nilai_${s.id}" value="${nilaiMap[s.id]||0}" min="0" max="100">
        </div>
      `).join('')}
    </div>
    <button class="btn btn-success btn-lg" style="width:100%" onclick="simpanNilai('${kelasId}','${mapelId}','${kategori}')"> Simpan Entri Nilai Baru</button>
  `;
}

async function simpanNilai(kelasId, mapelId, kategori) {
  const siswaKelas = APP_DATA.siswa.filter(s=>s.kelas_id==kelasId);
  const rows = siswaKelas.map(s=>({
    siswa_id: s.id, kelas_id: parseInt(kelasId), mapel_id: parseInt(mapelId),
    kategori, skor: parseInt(document.getElementById(`nilai_${s.id}`)?.value||0),
    tanggal: new Date().toISOString().split('T')[0], user_id: currentUser.id
  }));
  await db.from('nilai').delete().eq('kelas_id', kelasId).eq('mapel_id', mapelId).eq('kategori', kategori);
  const { error } = await db.from('nilai').insert(rows);
  if (error) return toast(error.message, 'error');
  toast('Nilai berhasil disimpan!', 'success');
}

// ===================== REKAP NILAI =====================
function updateRekapMapel() {
  const el = document.getElementById('rekapNilaiMapel');
  if (el) el.innerHTML = APP_DATA.mapel.length
    ? APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('')
    : '<option value="">-- tambah mapel di Pengaturan --</option>';
  loadRekapNilai();
}

async function loadRekapNilai() {
  const kelasId = document.getElementById('rekapNilaiKelas')?.value;
  const mapelId = document.getElementById('rekapNilaiMapel')?.value;
  if (!kelasId || !mapelId) return;
  const { data } = await db.from('nilai').select('*').eq('kelas_id', kelasId).eq('mapel_id', mapelId);
  const records = data || [];
  const siswaKelas = APP_DATA.siswa.filter(s=>s.kelas_id==kelasId);
  const cats = ['PR','Harian','Tugas','Projek','Portofolio','Sumatif','STS','SAS'];
  
  document.getElementById('rekapNilaiTbody').innerHTML = siswaKelas.map(s=>{
    const nilaiMap = {};
    records.filter(r=>r.siswa_id==s.id).forEach(r=>{ nilaiMap[r.kategori] = r.skor; });
    const scores = cats.map(c=>nilaiMap[c]||0);
    const filled = scores.filter(x=>x>0);
    const avg = filled.length ? Math.round(filled.reduce((a,b)=>a+b,0)/filled.length) : 0;
    return `<tr>
      <td><strong>${s.nama}</strong></td>
      ${scores.map(sc=>`<td class="score-cell ${sc>=80?'score-high':sc>=60?'score-mid':sc>0?'score-low':''}">${sc||0}</td>`).join('')}
      <td class="score-cell avg-col">${avg}</td>
    </tr>`;
  }).join('');
}

// ===================== JURNAL =====================
async function loadJurnal() {
  const kelasId = document.getElementById('filterJurnalKelas')?.value;
  const mapelId = document.getElementById('filterJurnalMapel')?.value;
  const bulan = document.getElementById('filterJurnalBulan')?.value;
  
  // Populate mapel filter
  const fmp = document.getElementById('filterJurnalMapel');
  if (fmp && fmp.options.length <= 1) {
    fmp.innerHTML = '<option value="">Semua Mapel</option>' +
      APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('');
  }
  
  let query = db.from('jurnal').select('*').order('tanggal', {ascending:false});
  if (kelasId) query = query.eq('kelas_id', kelasId);
  if (mapelId) query = query.eq('mapel_id', mapelId);
  if (bulan) query = query.like('tanggal', `%-${bulan}-%`);
  const { data } = await query;
  document.getElementById('jurnalList').innerHTML = (data||[]).length ? (data||[]).map(j=>`
    <div class="jurnal-card">
      <div style="display:flex;justify-content:space-between;align-items:flex-start">
        <div>
          <div class="jurnal-meta">${j.tanggal}  ${getKelasName(j.kelas_id)}  ${getMapelName(j.mapel_id)}  Pertemuan ke-${j.pertemuan||1}</div>
          <div style="font-size:14px;font-weight:700;margin-bottom:4px">${j.materi||''}</div>
          <div class="jurnal-content">${j.deskripsi||''}</div>
          ${j.catatan?`<div style="margin-top:6px;font-size:12px;color:var(--text-light);font-style:italic"> ${j.catatan}</div>`:''}
        </div>
        <div style="display:flex;gap:6px;flex-shrink:0">
          <button class="btn btn-sm btn-outline" onclick="editJurnal(${j.id})"></button>
          <button class="btn btn-sm btn-danger" onclick="deleteJurnal(${j.id})"></button>
        </div>
      </div>
    </div>
  `).join('') : '<div class="empty-state"><div class="empty-icon"></div><h3>Belum Ada Jurnal</h3><p>Tambahkan jurnal mengajar pertama Anda</p></div>';
}

function showAddJurnal() {
  editingId = null;
  document.getElementById('editJurnalId').value = '';
  document.getElementById('jurnalTgl').value = new Date().toISOString().split('T')[0];
  document.getElementById('jurnalKelas').innerHTML = APP_DATA.kelas.map(k=>`<option value="${k.id}">${k.nama}</option>`).join('');
  document.getElementById('jurnalMapel').innerHTML = APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('');
  document.getElementById('jurnalMateri').value = '';
  document.getElementById('jurnalDesc').value = '';
  document.getElementById('jurnalCatatan').value = '';
  document.getElementById('jurnalPertemuan').value = 1;
  openModal('modalJurnal');
}

async function editJurnal(id) {
  const { data } = await db.from('jurnal').select('*').eq('id',id).single();
  if (!data) return;
  editingId = id;
  document.getElementById('editJurnalId').value = id;
  document.getElementById('jurnalTgl').value = data.tanggal;
  document.getElementById('jurnalKelas').innerHTML = APP_DATA.kelas.map(k=>`<option value="${k.id}" ${k.id==data.kelas_id?'selected':''}>${k.nama}</option>`).join('');
  document.getElementById('jurnalMapel').innerHTML = APP_DATA.mapel.map(m=>`<option value="${m.id}" ${m.id==data.mapel_id?'selected':''}>${m.nama}</option>`).join('');
  document.getElementById('jurnalMateri').value = data.materi||'';
  document.getElementById('jurnalDesc').value = data.deskripsi||'';
  document.getElementById('jurnalCatatan').value = data.catatan||'';
  document.getElementById('jurnalPertemuan').value = data.pertemuan||1;
  openModal('modalJurnal');
}

async function saveJurnal() {
  const row = {
    tanggal: document.getElementById('jurnalTgl').value,
    kelas_id: document.getElementById('jurnalKelas').value,
    mapel_id: document.getElementById('jurnalMapel').value,
    materi: document.getElementById('jurnalMateri').value,
    deskripsi: document.getElementById('jurnalDesc').value,
    catatan: document.getElementById('jurnalCatatan').value,
    pertemuan: document.getElementById('jurnalPertemuan').value,
    user_id: currentUser.id
  };
  let err;
  if (editingId) {
    const res = await db.from('jurnal').update(row).eq('id',editingId); err=res.error;
  } else {
    const res = await db.from('jurnal').insert(row); err=res.error;
  }
  if (err) return toast(err.message, 'error');
  toast('Jurnal disimpan!', 'success'); closeModal('modalJurnal'); loadJurnal();
}

async function deleteJurnal(id) {
  if (!confirm('Hapus jurnal ini?')) return;
  await db.from('jurnal').delete().eq('id',id);
  toast('Jurnal dihapus'); loadJurnal();
}

// ===================== BIMBINGAN =====================
async function loadBimbingan() {
  const siswaId = document.getElementById('filterBimbinganSiswa')?.value;
  const kat = document.getElementById('filterBimbinganKat')?.value;
  let query = db.from('bimbingan').select('*').order('tanggal',{ascending:false});
  if (siswaId) query = query.eq('siswa_id', siswaId);
  if (kat) query = query.eq('kategori', kat);
  const { data } = await query;
  document.getElementById('bimbinganList').innerHTML = (data||[]).length ? (data||[]).map(b=>`
    <div class="bimbingan-item">
      <div style="display:flex;justify-content:space-between">
        <div>
          <div class="bimbingan-meta">
            <span>${b.tanggal}</span>
            <span class="badge badge-primary">${getSiswaName(b.siswa_id)}</span>
            <span class="badge badge-warning">${b.kategori}</span>
          </div>
          <div class="bimbingan-desc">Masalah: ${b.masalah||''}</div>
          <div class="bimbingan-sol"> Tindak Lanjut: ${b.solusi||''}</div>
        </div>
        <div><button class="btn btn-sm btn-danger" onclick="deleteBimbingan(${b.id})"></button></div>
      </div>
    </div>
  `).join('') : '<div class="empty-state"><div class="empty-icon"></div><h3>Belum Ada Catatan Bimbingan</h3></div>';
}

function showAddBimbingan() {
  editingId = null;
  document.getElementById('editBimbinganId').value = '';
  document.getElementById('bimbinganSiswa').innerHTML = APP_DATA.siswa.map(s=>`<option value="${s.id}">${s.nama} (${getKelasName(s.kelas_id)})</option>`).join('');
  document.getElementById('bimbinganTgl').value = new Date().toISOString().split('T')[0];
  document.getElementById('bimbinganMasalah').value = '';
  document.getElementById('bimbinganSolusi').value = '';
  openModal('modalBimbingan');
}

async function saveBimbingan() {
  const row = {
    siswa_id: document.getElementById('bimbinganSiswa').value,
    tanggal: document.getElementById('bimbinganTgl').value,
    kategori: document.getElementById('bimbinganKat').value,
    masalah: document.getElementById('bimbinganMasalah').value,
    solusi: document.getElementById('bimbinganSolusi').value,
    user_id: currentUser.id
  };
  const { error } = await db.from('bimbingan').insert(row);
  if (error) return toast(error.message, 'error');
  toast('Bimbingan disimpan!', 'success'); closeModal('modalBimbingan'); loadBimbingan();
}

async function deleteBimbingan(id) {
  if (!confirm('Hapus catatan ini?')) return;
  await db.from('bimbingan').delete().eq('id',id);
  toast('Dihapus'); loadBimbingan();
}

// ===================== INTEGRASI =====================
const defaultIntegrasi = [
  { nama: 'MyASN', url: 'https://myasn.bkn.go.id', ikon: '', desc: 'Portal ASN BKN' },
  { nama: 'e-Kinerja', url: 'https://kinerja.bkn.go.id', ikon: '', desc: 'Penilaian Kinerja ASN' },
  { nama: 'SSCASN', url: 'https://sscasn.bkn.go.id', ikon: '', desc: 'Portal Seleksi CPNS' },
  { nama: 'SIMPATIKA', url: 'https://simpatika.kemenag.go.id', ikon: '', desc: 'Sistem Informasi Pendidik' },
  { nama: 'Dapodik', url: 'https://dapo.kemdikbud.go.id', ikon: '', desc: 'Data Pokok Pendidikan' },
  { nama: 'PMM', url: 'https://guru.kemdikbud.go.id', ikon: '', desc: 'Platform Merdeka Mengajar' },
];

function renderIntegrasi() {
  const links = APP_DATA.integrasi.length ? APP_DATA.integrasi : defaultIntegrasi;
  document.getElementById('integrasiGrid').innerHTML = links.map((l,i)=>{
    // Icon: custom logo image > emoji > default
    const iconHtml = l.logo_base64 
      ? `<img src="${l.logo_base64}" alt="${l.nama}" style="width:100%;height:100%;object-fit:cover;border-radius:10px">`
      : (l.ikon||'');
    const actions = l.id ? `
      <div class="integration-actions">
        <button class="integration-edit" onclick="event.stopPropagation();event.preventDefault();editIntegrasi(${l.id})" title="Edit"></button>
        <button class="integration-del" onclick="event.stopPropagation();event.preventDefault();deleteIntegrasi(${l.id})" title="Hapus"></button>
      </div>` : '';
    return `
    <div class="integration-card" onclick="window.open('${l.url}','_blank')">
      <div class="integration-icon">${iconHtml}</div>
      <div class="integration-name">${l.nama}</div>
      <div class="integration-url">${l.deskripsi||l.desc||''}</div>
      ${actions}
    </div>`;
  }).join('');
}

function showAddIntegrasi() {
  document.getElementById('integrasiEditId').value = '';
  document.getElementById('integrasiNama').value = '';
  document.getElementById('integrasiUrl').value = '';
  document.getElementById('integrasiIkon').value = '';
  document.getElementById('integrasiDesc').value = '';
  document.getElementById('integrasiLogoPreview').style.display = 'none';
  document.getElementById('integrasiLogoB64').value = '';
  document.querySelector('#modalIntegrasi .modal-header h3').textContent = 'Tambah Link ASN';
  openModal('modalIntegrasi');
}

function editIntegrasi(id) {
  const l = APP_DATA.integrasi.find(x=>x.id==id); if(!l) return;
  document.getElementById('integrasiEditId').value = id;
  document.getElementById('integrasiNama').value = l.nama||'';
  document.getElementById('integrasiUrl').value = l.url||'';
  document.getElementById('integrasiIkon').value = l.ikon||'';
  document.getElementById('integrasiDesc').value = l.deskripsi||l.desc||'';
  const prev = document.getElementById('integrasiLogoPreview');
  if (l.logo_base64) { prev.src = l.logo_base64; prev.style.display='block'; }
  else { prev.style.display='none'; }
  document.getElementById('integrasiLogoB64').value = l.logo_base64||'';
  document.querySelector('#modalIntegrasi .modal-header h3').textContent = 'Edit Link ASN';
  openModal('modalIntegrasi');
}

async function saveIntegrasi() {
  const editId = document.getElementById('integrasiEditId').value;
  const row = {
    nama: document.getElementById('integrasiNama').value.trim(),
    url: document.getElementById('integrasiUrl').value.trim(),
    ikon: document.getElementById('integrasiIkon').value || '',
    deskripsi: document.getElementById('integrasiDesc').value.trim(),
    logo_base64: document.getElementById('integrasiLogoB64').value || null,
    user_id: currentUser.id
  };
  if (!row.nama || !row.url) return toast('Nama dan URL wajib diisi', 'error');
  let error;
  if (editId) {
    const res = await db.from('integrasi').update(row).eq('id', editId);
    error = res.error;
  } else {
    const res = await db.from('integrasi').insert(row);
    error = res.error;
  }
  if (error) return toast(error.message, 'error');
  toast(editId ? 'Link diperbarui! ' : 'Link ditambahkan! ', 'success');
  closeModal('modalIntegrasi');
  await loadIntegrasi();
}


// ===================== INTEGRASI KINERJA =====================

const defaultKinerja = [
  { nama: 'e-Kinerja BKN', url: 'https://kinerja.bkn.go.id', ikon: '', deskripsi: 'Penilaian Kinerja ASN' },
  { nama: 'PMM', url: 'https://guru.kemdikbud.go.id', ikon: '', deskripsi: 'Platform Merdeka Mengajar' },
  { nama: 'SIMPATIKA', url: 'https://simpatika.kemenag.go.id', ikon: '', deskripsi: 'Sistem Informasi Pendidik' },
  { nama: 'Rapor Pendidikan', url: 'https://raporpendidikan.kemdikbud.go.id', ikon: '', deskripsi: 'Rapor Pendidikan Sekolah' },
  { nama: 'ARKAS', url: 'https://arkas.kemdikbud.go.id', ikon: '', deskripsi: 'Aplikasi Rencana Kegiatan & Anggaran Sekolah' },
  { nama: 'SIPLah', url: 'https://siplah.kemdikbud.go.id', ikon: '', deskripsi: 'Sistem Informasi Pengadaan Sekolah' },
];

async function loadKinerja() {
  if (!db) return;
  const { data } = await db.from('kinerja').select('*').order('nama');
  APP_DATA.kinerja = data || [];
  renderKinerja();
}

function renderKinerja() {
  const links = (APP_DATA.kinerja && APP_DATA.kinerja.length) ? APP_DATA.kinerja : defaultKinerja;
  const grid = document.getElementById('kinerjaGrid');
  if (!grid) return;
  grid.innerHTML = links.map(l => {
    const iconHtml = l.logo_base64
      ? `<img src="${l.logo_base64}" alt="${l.nama}" style="width:100%;height:100%;object-fit:cover;border-radius:10px">`
      : (l.ikon || '');
    const actions = l.id ? `
      <div class="integration-actions">
        <button class="integration-edit" onclick="event.stopPropagation();event.preventDefault();editKinerja(${l.id})" title="Edit"></button>
        <button class="integration-del" onclick="event.stopPropagation();event.preventDefault();deleteKinerja(${l.id})" title="Hapus"></button>
      </div>` : '';
    return `
    <div class="integration-card" onclick="window.open('${l.url}','_blank')">
      <div class="integration-icon">${iconHtml}</div>
      <div class="integration-name">${l.nama}</div>
      <div class="integration-url">${l.deskripsi || ''}</div>
      ${actions}
    </div>`;
  }).join('');
}

function showAddKinerja() {
  document.getElementById('kinerjaEditId').value = '';
  document.getElementById('kinerjaNama').value = '';
  document.getElementById('kinerjaUrl').value = '';
  document.getElementById('kinerjaIkon').value = '';
  document.getElementById('kinerjaDesc').value = '';
  document.getElementById('kinerjaLogoPreview').style.display = 'none';
  document.getElementById('kinerjaLogoB64').value = '';
  document.getElementById('modalKinerjaTitle').textContent = 'Tambah Link Kinerja';
  openModal('modalKinerja');
}

function editKinerja(id) {
  const l = APP_DATA.kinerja.find(x => x.id == id); if (!l) return;
  document.getElementById('kinerjaEditId').value = id;
  document.getElementById('kinerjaNama').value = l.nama || '';
  document.getElementById('kinerjaUrl').value = l.url || '';
  document.getElementById('kinerjaIkon').value = l.ikon || '';
  document.getElementById('kinerjaDesc').value = l.deskripsi || '';
  const prev = document.getElementById('kinerjaLogoPreview');
  if (l.logo_base64) { prev.src = l.logo_base64; prev.style.display = 'block'; }
  else { prev.style.display = 'none'; }
  document.getElementById('kinerjaLogoB64').value = l.logo_base64 || '';
  document.getElementById('modalKinerjaTitle').textContent = 'Edit Link Kinerja';
  openModal('modalKinerja');
}

async function saveKinerja() {
  const editId = document.getElementById('kinerjaEditId').value;
  const row = {
    nama: document.getElementById('kinerjaNama').value.trim(),
    url: document.getElementById('kinerjaUrl').value.trim(),
    ikon: document.getElementById('kinerjaIkon').value || '',
    deskripsi: document.getElementById('kinerjaDesc').value.trim(),
    logo_base64: document.getElementById('kinerjaLogoB64').value || null,
    user_id: currentUser.id
  };
  if (!row.nama || !row.url) return toast('Nama dan URL wajib diisi', 'error');
  let error;
  if (editId) {
    const res = await db.from('kinerja').update(row).eq('id', editId);
    error = res.error;
  } else {
    const res = await db.from('kinerja').insert(row);
    error = res.error;
  }
  if (error) return toast(error.message, 'error');
  toast(editId ? 'Link diperbarui! ' : 'Link ditambahkan! ', 'success');
  closeModal('modalKinerja');
  await loadKinerja();
}

async function deleteKinerja(id) {
  if (!confirm('Hapus link kinerja ini?')) return;
  const { error } = await db.from('kinerja').delete().eq('id', id);
  if (error) return toast(error.message, 'error');
  toast('Link dihapus', 'success');
  APP_DATA.kinerja = APP_DATA.kinerja.filter(x => x.id != id);
  renderKinerja();
}

function handleKinerjaLogoUpload(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    document.getElementById('kinerjaLogoB64').value = e.target.result;
    const prev = document.getElementById('kinerjaLogoPreview');
    prev.src = e.target.result;
    prev.style.display = 'block';
  };
  reader.readAsDataURL(file);
}

function handleAppLogoUpload(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    CONFIG.appLogo = e.target.result;
    const prev = document.getElementById('appLogoPreview');
    if (prev) { prev.src = e.target.result; prev.style.display = 'block'; }
    const loginLogo = document.getElementById('loginLogo');
    if (loginLogo) loginLogo.innerHTML = `<img src="${e.target.result}" style="width:100%;height:100%;object-fit:cover;border-radius:16px">`;
    const sidebarLogo = document.getElementById('sidebarLogo');
    if (sidebarLogo) sidebarLogo.innerHTML = `<img src="${e.target.result}" style="width:36px;height:36px;object-fit:cover;border-radius:10px">`;
    toast('Logo berhasil diubah! Simpan pengaturan untuk menyimpan.', 'success');
  };
  reader.readAsDataURL(file);
}

function handleIntegLogoUpload(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    document.getElementById('integrasiLogoB64').value = e.target.result;
    document.getElementById('integrasiLogoPreview').src = e.target.result;
    document.getElementById('integrasiLogoPreview').style.display = 'block';
  };
  reader.readAsDataURL(file);
}

async function deleteIntegrasi(id) {
  if (!confirm('Hapus link ini?')) return;
  await db.from('integrasi').delete().eq('id',id);
  toast('Link dihapus'); await loadIntegrasi();
}



// Run this in Supabase SQL Editor if you added integrasi table before this update:
// ALTER TABLE integrasi ADD COLUMN IF NOT EXISTS logo_base64 TEXT;

// ===================== EXCEL UPLOAD / DOWNLOAD =====================

function downloadTemplateSiswa() {
  if (typeof XLSX === 'undefined') return toast('Library Excel belum siap, coba lagi', 'error');
  
  const wb = XLSX.utils.book_new();
  
  // Sheet 1: Template data siswa
  const templateData = [
    ['NISN', 'NAMA_LENGKAP', 'KELAS', 'JENIS_KELAMIN', 'BIMBINGAN_WALI'],
    ['1234567890', 'Contoh Nama Siswa', 'Kelas 7', 'Laki-laki', 'Tidak'],
    ['0987654321', 'Contoh Nama Siswi', 'Kelas 7', 'Perempuan', 'Ya'],
  ];
  const ws = XLSX.utils.aoa_to_sheet(templateData);
  
  // Styling column widths
  ws['!cols'] = [
    {wch: 15}, // NISN
    {wch: 30}, // NAMA
    {wch: 15}, // KELAS
    {wch: 15}, // JK
    {wch: 16}, // BIMBINGAN
  ];
  XLSX.utils.book_append_sheet(wb, ws, 'Data Siswa');
  
  // Sheet 2: Daftar kelas yang tersedia
  const kelasData = [['DAFTAR KELAS YANG TERSEDIA'], ...APP_DATA.kelas.map(k=>([k.nama]))];
  const wsKelas = XLSX.utils.aoa_to_sheet(kelasData);
  wsKelas['!cols'] = [{wch: 25}];
  XLSX.utils.book_append_sheet(wb, wsKelas, 'Daftar Kelas');
  
  XLSX.writeFile(wb, 'Template_Siswa_APEL_JUMBO.xlsx');
  toast('Template Excel berhasil didownload!', 'success');
}

async function uploadExcelSiswa(input) {
  const file = input.files[0];
  if (!file) return;
  if (typeof XLSX === 'undefined') return toast('Library Excel belum siap', 'error');
  
  // Show progress
  document.getElementById('uploadProgress').style.display = 'block';
  document.getElementById('uploadProgressBar').style.width = '0%';
  document.getElementById('uploadStatusText').textContent = 'Membaca file Excel...';
  document.getElementById('uploadCount').textContent = '';
  
  const reader = new FileReader();
  reader.onload = async (e) => {
    try {
      const data = new Uint8Array(e.target.result);
      const wb = XLSX.read(data, { type: 'array' });
      const ws = wb.Sheets[wb.SheetNames[0]];
      const rows = XLSX.utils.sheet_to_json(ws, { header: 1 });
      
      // Skip header row, filter empty rows
      const dataRows = rows.slice(1).filter(r => r[1] && String(r[1]).trim() !== '');
      
      if (dataRows.length === 0) {
        toast('Tidak ada data siswa di file Excel', 'error');
        document.getElementById('uploadProgress').style.display = 'none';
        input.value = '';
        return;
      }
      
      document.getElementById('uploadStatusText').textContent = `Memproses ${dataRows.length} siswa...`;
      
      let success = 0;
      let failed = 0;
      const errors = [];
      
      for (let i = 0; i < dataRows.length; i++) {
        const row = dataRows[i];
        const nisn = String(row[0] || '').trim();
        const nama = String(row[1] || '').trim();
        const kelasNama = String(row[2] || '').trim();
        const jk = String(row[3] || 'Laki-laki').trim();
        const bimbingan = String(row[4] || '').toLowerCase().includes('ya') ? 1 : 0;
        
        if (!nama) { failed++; continue; }
        
        // Find kelas_id by name (case insensitive)
        const kelas = APP_DATA.kelas.find(k => 
          k.nama.toLowerCase() === kelasNama.toLowerCase() ||
          k.nama.toLowerCase().includes(kelasNama.toLowerCase()) ||
          kelasNama.toLowerCase().includes(k.nama.toLowerCase())
        );
        
        if (!kelas && kelasNama) {
          errors.push(`Baris ${i+2}: Kelas "${kelasNama}" tidak ditemukan`);
          failed++;
          // Update progress
          const pct = Math.round((i+1) / dataRows.length * 100);
          document.getElementById('uploadProgressBar').style.width = pct + '%';
          document.getElementById('uploadCount').textContent = `${i+1}/${dataRows.length}`;
          continue;
        }
        
        const insertRow = {
          nis: nisn,
          nama: nama,
          kelas_id: kelas ? kelas.id : null,
          jenis_kelamin: jk,
          bimbingan: bimbingan,
          user_id: currentUser.id
        };
        
        const { error } = await db.from('siswa').insert(insertRow);
        if (error) { 
          failed++; 
          errors.push(`Baris ${i+2}: ${nama} - ${error.message}`);
        } else { 
          success++; 
        }
        
        // Update progress
        const pct = Math.round((i+1) / dataRows.length * 100);
        document.getElementById('uploadProgressBar').style.width = pct + '%';
        document.getElementById('uploadCount').textContent = `${i+1}/${dataRows.length}`;
        document.getElementById('uploadStatusText').textContent = `Mengupload: ${nama}...`;
      }
      
      // Done
      document.getElementById('uploadProgressBar').style.width = '100%';
      document.getElementById('uploadStatusText').textContent = ` Selesai! ${success} siswa berhasil, ${failed} gagal.`;
      
      if (errors.length > 0) {
        console.warn('Upload errors:', errors);
        setTimeout(()=>{ 
          alert('Beberapa data gagal diupload:\n' + errors.slice(0,5).join('\n') + (errors.length > 5 ? `\n...dan ${errors.length-5} lainnya` : ''));
        }, 500);
      }
      
      toast(` ${success} siswa berhasil diimport!`, 'success');
      
      // Reload data
      await loadSiswaAll();
      loadSiswa();
      populateAllSelects();
      
      // Hide progress after 3s
      setTimeout(()=>{ document.getElementById('uploadProgress').style.display = 'none'; }, 3000);
      
    } catch(err) {
      toast('Gagal membaca file: ' + err.message, 'error');
      document.getElementById('uploadProgress').style.display = 'none';
    }
    input.value = ''; // Reset input
  };
  reader.readAsArrayBuffer(file);
}

// ===================== KELAS & MAPEL =====================
function renderKelasTbody() {
  document.getElementById('kelasTbody').innerHTML = APP_DATA.kelas.map(k=>`
    <tr><td>${k.nama}</td><td><button class="btn btn-sm btn-danger" onclick="deleteKelas(${k.id})"></button></td></tr>
  `).join('') || '<tr><td colspan="2" style="text-align:center;color:var(--text-light)">Belum ada kelas</td></tr>';
}

function renderMapelTbody() {
  document.getElementById('mapelTbody').innerHTML = APP_DATA.mapel.map(m=>`
    <tr><td>${m.nama}</td><td><button class="btn btn-sm btn-danger" onclick="deleteMapel(${m.id})"></button></td></tr>
  `).join('') || '<tr><td colspan="2" style="text-align:center;color:var(--text-light)">Belum ada mapel</td></tr>';
}

async function addKelas() {
  if (!currentUser) return toast('Sesi belum siap, coba refresh halaman', 'error');
  const nama = document.getElementById('newKelas').value.trim();
  if (!nama) return toast('Nama kelas wajib diisi', 'error');
  const { error } = await db.from('kelas').insert({ nama, user_id: currentUser.id });
  if (error) return toast(error.message, 'error');
  document.getElementById('newKelas').value = '';
  toast('Kelas ditambahkan!', 'success');
  await loadKelas(); populateAllSelects();
}

async function deleteKelas(id) {
  if (!confirm('Hapus kelas ini?')) return;
  await db.from('kelas').delete().eq('id',id);
  await loadKelas(); populateAllSelects();
}

async function addMapel() {
  if (!currentUser) return toast('Sesi belum siap, coba refresh halaman', 'error');
  const nama = document.getElementById('newMapel').value.trim();
  if (!nama) return toast('Nama mapel wajib diisi', 'error');
  const { error } = await db.from('mapel').insert({ nama, user_id: currentUser.id });
  if (error) return toast(error.message, 'error');
  document.getElementById('newMapel').value = '';
  toast('Mapel ditambahkan!', 'success');
  await loadMapel(); populateAllSelects();
}

async function deleteMapel(id) {
  if (!confirm('Hapus mapel ini?')) return;
  await db.from('mapel').delete().eq('id',id);
  await loadMapel(); populateAllSelects();
}

// ===================== CETAK / PDF =====================
function getKopData() {
  return {
    school: CONFIG.school || 'NAMA SEKOLAH',
    subtitle: CONFIG.subtitle || '',
    npsn: CONFIG.npsn || '',
    address: CONFIG.address || '',
    phone: CONFIG.phone || '',
    guru: CONFIG.guru || '',
    logo: CONFIG.logo || null
  };
}

function addKopToPdf(doc, kop) {
  doc.setFillColor(26,86,219);
  doc.rect(0, 0, 210, 32, 'F');
  if (kop.logo) {
    try { doc.addImage(kop.logo, 'PNG', 8, 4, 22, 22); } catch(e) {}
  }
  doc.setFontSize(14); doc.setFont('helvetica','bold'); doc.setTextColor(255,255,255);
  doc.text(kop.school, 34, 12);
  doc.setFontSize(8); doc.setFont('helvetica','normal');
  doc.text(kop.subtitle || kop.address || '', 34, 18);
  doc.text(`NPSN: ${kop.npsn} | Telp: ${kop.phone}`, 34, 23);
  doc.setDrawColor(255,255,255); doc.setLineWidth(0.3); doc.line(0, 30, 210, 30);
  doc.setTextColor(30,30,30);
  // watermark
  doc.setFontSize(7); doc.setTextColor(180,180,180);
  doc.text('Created & Developed by D.D Candra', 105, 292, {align:'center'});
  doc.setTextColor(30,30,30);
}

function cetakSiswa() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const kop = getKopData();
  addKopToPdf(doc, kop);
  doc.setFontSize(12); doc.setFont('helvetica','bold');
  doc.text('DATA SISWA', 105, 40, {align:'center'});
  const rows = APP_DATA.siswa.map(s=>[s.nis||'-',s.nama,getKelasName(s.kelas_id),s.jenis_kelamin||'-',s.bimbingan==1?'Ya':'Tidak']);
  doc.autoTable({ startY:44, head:[['NISN','Nama','Kelas','JK','Bimbingan']], body:rows, styles:{fontSize:9}, headStyles:{fillColor:[26,86,219]} });
  doc.save('data-siswa.pdf'); toast('PDF berhasil diunduh!', 'success');
}

function cetakAbsensi() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF('landscape');
  const kop = getKopData();
  // Simple landscape kop
  doc.setFillColor(26,86,219); doc.rect(0,0,297,25,'F');
  doc.setFontSize(14); doc.setFont('helvetica','bold'); doc.setTextColor(255,255,255);
  doc.text('REKAP ABSENSI SISWA', 148,12,{align:'center'});
  doc.setFontSize(9); doc.setFont('helvetica','normal');
  doc.text(`${kop.school} | ${kop.address}`, 148,19,{align:'center'});
  doc.setTextColor(30,30,30);
  const rows = [];
  document.querySelectorAll('#rekapAbsenTbody tr').forEach(tr=>{
    const cells = [...tr.querySelectorAll('td')].map(td=>td.textContent.trim());
    rows.push(cells);
  });
  doc.autoTable({ startY:30, head:[['Nama','Kelas','Jml Hari','H','S','I','A','% Hadir']], body:rows, styles:{fontSize:9}, headStyles:{fillColor:[26,86,219]} });
  doc.setFontSize(7); doc.setTextColor(180,180,180);
  doc.text('Created & Developed by D.D Candra', 148,200,{align:'center'});
  doc.save('rekap-absensi.pdf'); toast('PDF berhasil diunduh!', 'success');
}

function cetakNilai() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF('landscape');
  const kop = getKopData();
  doc.setFillColor(26,86,219); doc.rect(0,0,297,25,'F');
  doc.setFontSize(14); doc.setFont('helvetica','bold'); doc.setTextColor(255,255,255);
  doc.text('REKAPITULASI NILAI SISWA', 148,12,{align:'center'});
  doc.setFontSize(9); doc.setFont('helvetica','normal');
  doc.text(`${kop.school} | ${getKelasName(document.getElementById('rekapNilaiKelas').value)} | ${getMapelName(document.getElementById('rekapNilaiMapel').value)}`, 148,19,{align:'center'});
  doc.setTextColor(30,30,30);
  const rows = [];
  document.querySelectorAll('#rekapNilaiTbody tr').forEach(tr=>{
    const cells = [...tr.querySelectorAll('td')].map(td=>td.textContent.trim());
    rows.push(cells);
  });
  doc.autoTable({ startY:30, head:[['Nama','PR','HRN','TGS','PRJ','PFT','SUM','STS','SAS','AVG']], body:rows, styles:{fontSize:9}, headStyles:{fillColor:[26,86,219]} });
  doc.setFontSize(7); doc.setTextColor(180,180,180);
  doc.text('Created & Developed by D.D Candra', 148,200,{align:'center'});
  doc.save('rekap-nilai.pdf'); toast('PDF berhasil diunduh!', 'success');
}

function cetakJadwal() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const kop = getKopData();
  addKopToPdf(doc, kop);
  doc.setFontSize(12); doc.setFont('helvetica','bold');
  doc.text('JADWAL MENGAJAR', 105, 40, {align:'center'});
  const rows = APP_DATA.jadwal.map(j=>[j.hari,`${j.jam_mulai}-${j.jam_selesai}`,getKelasName(j.kelas_id),getMapelName(j.mapel_id),j.ruang||'-']);
  doc.autoTable({ startY:44, head:[['Hari','Jam','Kelas','Mata Pelajaran','Ruang']], body:rows, styles:{fontSize:9}, headStyles:{fillColor:[26,86,219]} });
  doc.save('jadwal-mengajar.pdf'); toast('PDF berhasil diunduh!', 'success');
}

async function cetakJurnal() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const kop = getKopData();
  addKopToPdf(doc, kop);
  doc.setFontSize(12); doc.setFont('helvetica','bold');
  doc.text('JURNAL MENGAJAR', 105, 40, {align:'center'});
  const { data } = await db.from('jurnal').select('*').order('tanggal',{ascending:false});
  const rows = (data||[]).map(j=>[j.tanggal, getKelasName(j.kelas_id), getMapelName(j.mapel_id), j.materi||'', (j.deskripsi||'').substring(0,40)+'...']);
  doc.autoTable({ startY:44, head:[['Tanggal','Kelas','Mapel','Materi','Deskripsi']], body:rows, styles:{fontSize:8}, headStyles:{fillColor:[26,86,219]} });
  doc.save('jurnal-mengajar.pdf'); toast('PDF berhasil diunduh!', 'success');
}

async function cetakBimbingan() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const kop = getKopData();
  addKopToPdf(doc, kop);
  doc.setFontSize(12); doc.setFont('helvetica','bold');
  doc.text('CATATAN BIMBINGAN WALI KELAS', 105, 40, {align:'center'});
  const { data } = await db.from('bimbingan').select('*').order('tanggal',{ascending:false});
  const rows = (data||[]).map(b=>[b.tanggal, getSiswaName(b.siswa_id), b.kategori, (b.masalah||'').substring(0,30), (b.solusi||'').substring(0,30)]);
  doc.autoTable({ startY:44, head:[['Tanggal','Siswa','Kategori','Masalah','Solusi']], body:rows, styles:{fontSize:8}, headStyles:{fillColor:[26,86,219]} });
  doc.save('catatan-bimbingan.pdf'); toast('PDF berhasil diunduh!', 'success');
}


// ===================== UMMI PEMBAYARAN =====================

// Store tingkatan data per level
let ummiTingkatanData = {}; // per-level cache untuk grid tampilan
let ummiTingkatanAll = []; // semua tingkatan (untuk dropdown form pembayaran)

// Cache: siswa per tingkatan_id  { tingkatan_id: [{ nama, kelas }] }
let ummiSiswaPerTingkatan = {};

async function loadAllTingkatan() {
  // Load tingkatan per level dan siswa-nya secara paralel
  await Promise.all(['7','8','9'].map(async lvl => {
    const t = await loadUmmiTingkatan(lvl);
    renderTingkatanGrid(lvl, t);
  }));
  // Refresh cache global tingkatan + siswa mapping
  await loadTingkatanAll();
  await loadSiswaPerTingkatan();
  // Re-render semua grid agar tampil nama siswa
  ['7','8','9'].forEach(lvl => renderTingkatanGrid(lvl, ummiTingkatanData[lvl] || []));
}

// Load tingkatan per-level (untuk halaman manajemen tingkatan)
async function loadUmmiTingkatan(lvl) {
  const { data } = await db.from('ummi_tingkatan')
    .select('*').eq('level', lvl).order('urutan');
  ummiTingkatanData[lvl] = data || [];
  return ummiTingkatanData[lvl];
}

// Load SEMUA tingkatan dari semua level (untuk dropdown form pembayaran)
async function loadTingkatanAll() {
  const { data } = await db.from('ummi_tingkatan')
    .select('*').order('level').order('urutan');
  ummiTingkatanAll = data || [];
  return ummiTingkatanAll;
}

// Load mapping: tiap tingkatan_id  daftar siswa yang punya pembayaran dengan tingkatan itu
async function loadSiswaPerTingkatan() {
  // Ambil semua record ummi yang punya tingkatan_id
  const { data: ummiRecords } = await db.from('ummi')
    .select('siswa_id, tingkatan_id, level')
    .not('tingkatan_id', 'is', null);
  
  ummiSiswaPerTingkatan = {};
  if (!ummiRecords) return;

  // Deduplicate: satu siswa per tingkatan (siswa bisa bayar banyak bulan)
  const seen = new Set();
  ummiRecords.forEach(r => {
    const key = `${r.tingkatan_id}_${r.siswa_id}`;
    if (seen.has(key)) return;
    seen.add(key);
    if (!ummiSiswaPerTingkatan[r.tingkatan_id]) ummiSiswaPerTingkatan[r.tingkatan_id] = [];
    const siswa = APP_DATA.siswa.find(s => s.id == r.siswa_id);
    if (siswa) {
      ummiSiswaPerTingkatan[r.tingkatan_id].push({
        nama: siswa.nama,
        kelas: getKelasName(siswa.kelas_id)
      });
    }
  });
}

// Refresh daftar siswa di grid tingkatan (dipanggil setelah simpan/hapus pembayaran)
async function refreshTingkatanSiswa() {
  await loadSiswaPerTingkatan();
  ['7','8','9'].forEach(lvl => {
    if (ummiTingkatanData[lvl]?.length) {
      renderTingkatanGrid(lvl, ummiTingkatanData[lvl]);
    }
  });
}
function renderTingkatanDropdown() {
  const sel = document.getElementById('ummiTingkatanId');
  if (!sel) return;
  // Kelompokkan per level
  const grouped = { '7': [], '8': [], '9': [] };
  ummiTingkatanAll.forEach(t => { if (grouped[t.level]) grouped[t.level].push(t); });
  let html = '<option value="">-- Pilih Tingkatan --</option>';
  ['7','8','9'].forEach(lvl => {
    if (grouped[lvl].length) {
      html += `<optgroup label="Kelas ${lvl}">`;
      grouped[lvl].forEach(t => { html += `<option value="${t.id}">${t.nama}</option>`; });
      html += '</optgroup>';
    }
  });
  sel.innerHTML = html;
}

function renderUmmiPage(level) {
  const levelMap = { 'ummi7': '7', 'ummi8': '8', 'ummi9': '9' };
  const lvl = levelMap[level] || level;
  const colors = { '7': '#059669', '8': '#1a56db', '9': '#d97706' };
  const color = colors[lvl] || '#1a56db';
  const icons = { '7': '', '8': '', '9': '' };
  
  // Filter siswa for this level based on kelas name containing the level number
  const siswaTingkat = APP_DATA.siswa.filter(s => {
    const kelasName = getKelasName(s.kelas_id);
    return kelasName.includes(lvl);
  });
  
  const html = `
    <div style="display:flex;justify-content:flex-end;gap:10px;margin-bottom:20px">
      <button class="btn btn-primary" onclick="showAddUmmi('${lvl}')">+ Input Pembayaran</button>
      <button class="btn btn-print" onclick="cetakUmmi('${lvl}')"> Cetak PDF</button>
    </div>
    
    <div class="card" style="margin-bottom:16px">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Filter Kelas</label>
          <select id="ummiFilterKelas${lvl}" class="form-control" onchange="loadUmmiData('${lvl}')">
            <option value="">Semua Kelas ${lvl}</option>
            ${APP_DATA.kelas.filter(k=>k.nama.includes(lvl)).map(k=>`<option value="${k.id}">${k.nama}</option>`).join('')}
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Filter Bulan</label>
          <select id="ummiFilterBulan${lvl}" class="form-control" onchange="loadUmmiData('${lvl}')">
            <option value="">Semua Bulan</option>
            ${['Juli','Agustus','September','Oktober','November','Desember','Januari','Februari','Maret','April','Mei','Juni'].map(b=>`<option>${b}</option>`).join('')}
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Filter Semester</label>
          <select id="ummiFilterSemester${lvl}" class="form-control" onchange="loadUmmiData('${lvl}')">
            <option value="">Semua Semester</option>
            <option>Ganjil</option><option>Genap</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Summary cards -->
    <div class="grid grid-3" style="margin-bottom:20px" id="ummiSummary${lvl}">
      <div class="stat-card"><div class="stat-icon" style="background:#d1fae5"><span style="font-size:20px"></span></div><div class="stat-info"><h3 id="ummiLunas${lvl}" style="color:#059669">0</h3><p>Sudah Lunas</p></div></div>
      <div class="stat-card"><div class="stat-icon" style="background:#fee2e2"><span style="font-size:20px"></span></div><div class="stat-info"><h3 id="ummiBelum${lvl}" style="color:#e02424">0</h3><p>Belum Lunas</p></div></div>
      <div class="stat-card"><div class="stat-icon" style="background:#fef3c7"><span style="font-size:20px"></span></div><div class="stat-info"><h3 id="ummiTotal${lvl}" style="color:#d97706;font-size:16px">Rp 0</h3><p>Total Terkumpul</p></div></div>
    </div>

    <!-- Rekap table by siswa x bulan -->
    <div class="card">
      <div class="card-header">
        <span class="card-title">Rekap Pembayaran per Siswa</span>
      </div>
      <div class="table-wrap">
        <table id="ummiTable${lvl}">
          <thead>
            <tr>
              <th>Nama Siswa</th>
              <th>Kelas</th>
              <th style="text-align:center">Juli</th>
              <th style="text-align:center">Agustus</th>
              <th style="text-align:center">September</th>
              <th style="text-align:center">Oktober</th>
              <th style="text-align:center">November</th>
              <th style="text-align:center">Desember</th>
              <th style="text-align:center">Januari</th>
              <th style="text-align:center">Februari</th>
              <th style="text-align:center">Maret</th>
              <th style="text-align:center">April</th>
              <th style="text-align:center">Mei</th>
              <th style="text-align:center">Juni</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="ummiTbody${lvl}"><tr><td colspan="14" style="text-align:center;padding:30px;color:var(--text-light)">Memuat data...</td></tr></tbody>
        </table>
      </div>
    </div>
  `;
  document.getElementById(`${level}-content`).innerHTML = html;
  loadUmmiData(lvl);
}

async function loadUmmiData(lvl) {
  const kelasFilter = document.getElementById(`ummiFilterKelas${lvl}`)?.value;
  const bulanFilter = document.getElementById(`ummiFilterBulan${lvl}`)?.value;
  const semesterFilter = document.getElementById(`ummiFilterSemester${lvl}`)?.value;
  
  let query = db.from('ummi').select('*').eq('level', lvl);
  if (bulanFilter) query = query.eq('bulan', bulanFilter);
  if (semesterFilter) query = query.eq('semester', semesterFilter);
  const { data: ummiRecords } = await query;
  const records = ummiRecords || [];
  
  // Get siswa for this level
  let siswaLevel = APP_DATA.siswa.filter(s => getKelasName(s.kelas_id).includes(lvl));
  if (kelasFilter) siswaLevel = siswaLevel.filter(s => s.kelas_id == kelasFilter);
  
  const bulanList = ['Juli','Agustus','September','Oktober','November','Desember','Januari','Februari','Maret','April','Mei','Juni'];
  
  const tbody = document.getElementById(`ummiTbody${lvl}`);
  if (!tbody) return;
  
  let lunas = 0, belum = 0, total = 0;
  
  tbody.innerHTML = siswaLevel.length ? siswaLevel.map(s => {
    const siswaRec = records.filter(r => r.siswa_id == s.id);
    const bulanCells = bulanList.map(bl => {
      const rec = siswaRec.find(r => r.bulan === bl);
      if (rec) {
        const dot = rec.status === 'Lunas' ? '' : rec.status === 'Cicilan' ? '' : '';
        const tgl = rec.tanggal ? new Date(rec.tanggal).toLocaleDateString('id-ID',{day:'2-digit',month:'2-digit',year:'numeric'}) : '-';
        return `<td style="text-align:center;font-size:11px"><span title="${rec.status}">${dot}</span><br><span style="color:var(--text-light)">${tgl}</span></td>`;
      }
      return `<td style="text-align:center;color:#cbd5e1;font-size:16px"></td>`;
    });
    // Count
    const siswaLunas = siswaRec.filter(r=>r.status==='Lunas').length;
    lunas += siswaLunas; total += siswaRec.reduce((a,r)=>a+(r.nominal||0),0);
    return `<tr>
      <td><strong>${s.nama}</strong></td>
      <td>${getKelasName(s.kelas_id)}</td>
      ${bulanCells.join('')}
      <td>
        <button class="btn btn-sm btn-primary" onclick="showAddUmmi('${lvl}', ${s.id})" title="Input bayar">+</button>
        <button class="btn btn-sm btn-danger" onclick="hapusUmmiSiswa(${s.id},'${lvl}')" title="Hapus data"></button>
      </td>
    </tr>`;
  }).join('') : `<tr><td colspan="14" style="text-align:center;padding:30px;color:var(--text-light)">Tidak ada siswa untuk UMMI ${lvl}</td></tr>`;
  
  belum = siswaLevel.length * 12 - lunas;
  const el_lunas = document.getElementById(`ummiLunas${lvl}`);
  const el_belum = document.getElementById(`ummiBelum${lvl}`);
  const el_total = document.getElementById(`ummiTotal${lvl}`);
  if (el_lunas) el_lunas.textContent = lunas;
  if (el_belum) el_belum.textContent = Math.max(0, belum);
  if (el_total) el_total.textContent = 'Rp ' + total.toLocaleString('id-ID');
}

async function showAddUmmi(lvl, preSiswaId = null) {
  document.getElementById('ummiLevel').value = lvl;
  document.getElementById('ummiEditId').value = '';
  document.getElementById('ummiTgl').value = new Date().toISOString().split('T')[0];
  document.getElementById('ummiTP').value = CONFIG.tahunPelajaran || `${new Date().getFullYear()}/${new Date().getFullYear()+1}`;
  
  // Filter siswa for this level
  const siswaTingkat = APP_DATA.siswa.filter(s => getKelasName(s.kelas_id).includes(lvl));
  document.getElementById('ummiSiswa').innerHTML = siswaTingkat.map(s => 
    `<option value="${s.id}" ${preSiswaId==s.id?'selected':''}>${s.nama} (${getKelasName(s.kelas_id)})</option>`
  ).join('') || '<option value="">-- tidak ada siswa --</option>';
  
  document.getElementById('modalUmmiTitle').textContent = `Input Pembayaran UMMI ${lvl}`;
  document.getElementById('ummiNominal').value = '';
  document.getElementById('ummiCatatan').value = '';
  // Populate tingkatan dropdown dari semua level (global)
  if (!ummiTingkatanAll.length) await loadTingkatanAll();
  renderTingkatanDropdown();
  openModal('modalUmmi');
}

async function saveUmmi() {
  const lvl = document.getElementById('ummiLevel').value;
  const row = {
    siswa_id: document.getElementById('ummiSiswa').value,
    level: lvl,
    tanggal: document.getElementById('ummiTgl').value,
    bulan: document.getElementById('ummiBulan').value,
    semester: document.getElementById('ummiSemester').value,
    tahun_pelajaran: document.getElementById('ummiTP').value,
    status: document.getElementById('ummiStatus').value,
    nominal: parseInt(document.getElementById('ummiNominal').value) || 0,
    catatan: document.getElementById('ummiCatatan').value,
    tingkatan_id: document.getElementById('ummiTingkatanId').value || null,
    user_id: currentUser.id
  };
  if (!row.siswa_id) return toast('Pilih siswa terlebih dahulu', 'error');
  
  // Check if already exists for this siswa+bulan+level, upsert
  const { data: existing } = await db.from('ummi').select('id')
    .eq('siswa_id', row.siswa_id).eq('bulan', row.bulan).eq('level', lvl);
  
  let err;
  if (existing && existing.length > 0) {
    const res = await db.from('ummi').update(row).eq('id', existing[0].id);
    err = res.error;
  } else {
    const res = await db.from('ummi').insert(row);
    err = res.error;
  }
  if (err) return toast(err.message, 'error');
  toast(`Pembayaran UMMI ${lvl} disimpan! `, 'success');
  closeModal('modalUmmi');
  loadUmmiData(lvl);
  // Refresh daftar siswa di halaman Tingkatan UMMI jika sedang terbuka
  refreshTingkatanSiswa();
}

async function hapusUmmiSiswa(siswaId, lvl) {
  if (!confirm('Hapus semua data pembayaran UMMI siswa ini?')) return;
  const { error } = await db.from('ummi').delete().eq('siswa_id', siswaId).eq('level', lvl);
  if (error) return toast(error.message, 'error');
  toast('Data dihapus', 'success');
  loadUmmiData(lvl);
  refreshTingkatanSiswa();
}

function cetakUmmi(lvl) {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF('landscape');
  const kop = getKopData();
  doc.setFillColor(26,86,219); doc.rect(0,0,297,25,'F');
  doc.setFontSize(13); doc.setFont('helvetica','bold'); doc.setTextColor(255,255,255);
  doc.text(`REKAP PEMBAYARAN UMMI ${lvl}`, 148,12,{align:'center'});
  doc.setFontSize(9); doc.setFont('helvetica','normal');
  doc.text(`${kop.school} | T.P. ${CONFIG.tahunPelajaran||''}`, 148,19,{align:'center'});
  doc.setTextColor(30,30,30);
  
  const bulanList = ['Juli','Agus','Sep','Okt','Nov','Des','Jan','Feb','Mar','Apr','Mei','Jun'];
  const rows = [];
  const tbody = document.getElementById(`ummiTbody${lvl}`);
  if (tbody) {
    tbody.querySelectorAll('tr').forEach(tr => {
      const cells = [...tr.querySelectorAll('td')];
      if (cells.length > 2) {
        const nama = cells[0]?.textContent.trim() || '';
        const kelas = cells[1]?.textContent.trim() || '';
        const bulanData = cells.slice(2, 14).map(td => td.textContent.trim().replace('','').replace('','L').replace('','BL').replace('','C').trim() || '-');
        rows.push([nama, kelas, ...bulanData]);
      }
    });
  }
  
  doc.autoTable({
    startY: 30,
    head: [['Nama Siswa', 'Kelas', ...bulanList]],
    body: rows,
    styles: { fontSize: 7 },
    headStyles: { fillColor: [26,86,219] },
    columnStyles: { 0: { cellWidth: 40 }, 1: { cellWidth: 15 } }
  });
  doc.setFontSize(7); doc.setTextColor(180,180,180);
  doc.text('Created & Developed by D.D Candra', 148, 200, {align:'center'});
  doc.save(`rekap-ummi-${lvl}.pdf`);
  toast('PDF UMMI berhasil diunduh!', 'success');
}


// ===================== UMMI TINGKATAN =====================

function renderTingkatanGrid(lvl, tingkatan) {
  const grid = document.getElementById(`tingkatanGrid${lvl}`);
  if (!grid) return;
  if (!tingkatan.length) {
    grid.innerHTML = `
      <div style="width:100%;text-align:center;padding:16px 0;color:var(--text-light);font-size:13px">
        Belum ada tingkatan. Tambahkan tingkatan seperti Iqro 16 dan Al-Quran.
      </div>`;
    return;
  }

  grid.innerHTML = tingkatan.map(t => {
    const siswaList = ummiSiswaPerTingkatan[t.id] || [];
    const siswaHtml = siswaList.length
      ? `<div style="margin-top:10px;border-top:1px solid ${t.warna}22;padding-top:8px">
          <div style="font-size:10px;font-weight:700;color:${t.warna}99;margin-bottom:6px;letter-spacing:.5px">
            SISWA (${siswaList.length})
          </div>
          <div style="display:flex;flex-wrap:wrap;gap:4px">
            ${siswaList.map(s => `
              <span style="background:white;border:1px solid ${t.warna}44;border-radius:6px;padding:2px 8px;font-size:11px;color:var(--text);font-weight:500;white-space:nowrap">
                ${s.nama} <span style="color:${t.warna};font-size:10px">(${s.kelas})</span>
              </span>`).join('')}
          </div>
        </div>`
      : `<div style="margin-top:8px;font-size:11px;color:${t.warna}66;font-style:italic">Belum ada siswa</div>`;

    return `
      <div style="background:${t.warna}0d;border:1.5px solid ${t.warna}44;border-radius:12px;padding:10px 14px;min-width:180px;max-width:100%;flex:1">
        <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
          <span style="font-size:13px;font-weight:800;color:${t.warna}">${t.nama}</span>
          <span style="font-size:10px;color:${t.warna}88;font-weight:600">Urutan: ${t.urutan}</span>
          <div style="margin-left:auto;display:flex;gap:4px">
            <button onclick="editTingkatan(${t.id},'${lvl}')" style="background:none;border:none;cursor:pointer;font-size:13px;padding:2px" title="Edit"></button>
            <button onclick="deleteTingkatan(${t.id},'${lvl}')" style="background:none;border:none;cursor:pointer;font-size:13px;padding:2px;color:#e02424" title="Hapus"></button>
          </div>
        </div>
        ${siswaHtml}
      </div>`;
  }).join('');
}

function pilihCepatTingkatan(nama, urutan) {
  document.getElementById('tingkatanNama').value = nama;
  document.getElementById('tingkatanUrutan').value = urutan;
  const warnaMap = {
    'Iqro 1':'#059669','Iqro 2':'#0284c7','Iqro 3':'#7c3aed',
    'Iqro 4':'#d97706','Iqro 5':'#dc2626','Iqro 6':'#db2777','Al-Quran':'#1a56db'
  };
  document.getElementById('tingkatanWarna').value = warnaMap[nama] || '#1a56db';
}

function renderTingkatanQuickBtns() {
  const defaults = ['Iqro 1','Iqro 2','Iqro 3','Iqro 4','Iqro 5','Iqro 6','Al-Quran'];
  const container = document.getElementById('tingkatanQuickBtns');
  if (!container) return;
  container.innerHTML = defaults.map((t, i) => `
    <button type="button" onclick="pilihCepatTingkatan('${t}',${i+1})"
      style="background:white;border:1.5px solid var(--border);border-radius:8px;padding:5px 12px;font-size:12px;cursor:pointer;font-weight:600;color:var(--text);"
      onmouseover="this.style.borderColor='var(--primary)';this.style.color='var(--primary)'"
      onmouseout="this.style.borderColor='var(--border)';this.style.color='var(--text)'">
      ${t}
    </button>`).join('');
}

async function tambahSemuaTingkatan() {
  const lvl = document.getElementById('tingkatanLevel').value;
  if (!lvl) return toast('Level tidak diketahui', 'error');
  if (!confirm(`Tambah Iqro 16 dan Al-Quran untuk UMMI ${lvl}? Tingkatan yang sudah ada akan dilewati.`)) return;

  const defaults = [
    { nama:'Iqro 1', urutan:1, warna:'#059669' },
    { nama:'Iqro 2', urutan:2, warna:'#0284c7' },
    { nama:'Iqro 3', urutan:3, warna:'#7c3aed' },
    { nama:'Iqro 4', urutan:4, warna:'#d97706' },
    { nama:'Iqro 5', urutan:5, warna:'#dc2626' },
    { nama:'Iqro 6', urutan:6, warna:'#db2777' },
    { nama:'Al-Quran', urutan:7, warna:'#1a56db' },
  ];

  const existing = (ummiTingkatanData[lvl] || []).map(t => t.nama);
  const toAdd = defaults.filter(d => !existing.includes(d.nama));

  if (!toAdd.length) {
    toast('Semua tingkatan sudah ada!', 'success');
    closeModal('modalTingkatan');
    return;
  }

  let berhasil = 0;
  for (const t of toAdd) {
    const { error } = await db.from('ummi_tingkatan').insert({
      level: lvl, nama: t.nama, urutan: t.urutan, warna: t.warna, user_id: currentUser.id
    });
    if (!error) berhasil++;
  }

  toast(`${berhasil} tingkatan berhasil ditambahkan! `, 'success');
  closeModal('modalTingkatan');
  const tingkatan = await loadUmmiTingkatan(lvl);
  renderTingkatanGrid(lvl, tingkatan);
  await loadTingkatanAll(); // refresh cache global
}

function showAddTingkatan(lvl) {
  document.getElementById('tingkatanEditId').value = '';
  document.getElementById('tingkatanLevel').value = lvl;
  document.getElementById('tingkatanNama').value = '';
  document.getElementById('tingkatanUrutan').value = (ummiTingkatanData[lvl]?.length || 0) + 1;
  document.getElementById('tingkatanWarna').value = lvl==='7'?'#059669':lvl==='8'?'#1a56db':'#d97706';
  document.getElementById('modalTingkatanTitle').textContent = `Tambah Tingkatan UMMI ${lvl}`;

  // Tampilkan info siswa & kelas untuk level ini
  const siswaLvl = APP_DATA.siswa.filter(s => getKelasName(s.kelas_id).includes(lvl));
  const kelasList = [...new Set(siswaLvl.map(s => getKelasName(s.kelas_id)))].filter(Boolean);
  const infoEl = document.getElementById('tingkatanSiswaInfo');
  const detailEl = document.getElementById('tingkatanSiswaDetail');
  if (infoEl && detailEl) {
    if (kelasList.length) {
      detailEl.innerHTML = `<strong>Kelas ${lvl}:</strong> ${kelasList.join(', ')} &nbsp;&nbsp; <strong>${siswaLvl.length} siswa</strong>`;
      infoEl.style.display = 'block';
    } else {
      infoEl.style.display = 'none';
    }
  }

  // Render tombol cepat via JS (bukan template literal di HTML)
  renderTingkatanQuickBtns();

  // Tampilkan bagian bulk
  const bulkSection = document.getElementById('tingkatanBulkSection');
  if (bulkSection) bulkSection.style.display = 'block';

  openModal('modalTingkatan');
}

async function editTingkatan(id, lvl) {
  const t = (ummiTingkatanData[lvl]||[]).find(x=>x.id==id); if (!t) return;
  document.getElementById('tingkatanEditId').value = id;
  document.getElementById('tingkatanLevel').value = lvl;
  document.getElementById('tingkatanNama').value = t.nama;
  document.getElementById('tingkatanUrutan').value = t.urutan;
  document.getElementById('tingkatanWarna').value = t.warna||'#1a56db';
  document.getElementById('modalTingkatanTitle').textContent = `Edit Tingkatan UMMI ${lvl}`;
  // Sembunyikan bulk & siswa info saat edit
  const bulkSection = document.getElementById('tingkatanBulkSection');
  if (bulkSection) bulkSection.style.display = 'none';
  const infoEl = document.getElementById('tingkatanSiswaInfo');
  if (infoEl) infoEl.style.display = 'none';
  // Tetap render tombol cepat
  renderTingkatanQuickBtns();
  openModal('modalTingkatan');
}

async function saveTingkatan() {
  const id = document.getElementById('tingkatanEditId').value;
  const lvl = document.getElementById('tingkatanLevel').value;
  const row = {
    level: lvl,
    nama: document.getElementById('tingkatanNama').value.trim(),
    urutan: parseInt(document.getElementById('tingkatanUrutan').value)||0,
    warna: document.getElementById('tingkatanWarna').value||'#1a56db',
    user_id: currentUser.id
  };
  if (!row.nama) return toast('Nama tingkatan wajib diisi','error');
  let error;
  if (id) {
    const res = await db.from('ummi_tingkatan').update(row).eq('id',id); error=res.error;
  } else {
    const res = await db.from('ummi_tingkatan').insert(row); error=res.error;
  }
  if (error) return toast(error.message,'error');
  toast(id?'Tingkatan diperbarui! ':'Tingkatan ditambahkan! ','success');
  closeModal('modalTingkatan');
  const tingkatan = await loadUmmiTingkatan(lvl);
  renderTingkatanGrid(lvl, tingkatan);
  await loadTingkatanAll(); // refresh cache global
  // Also refresh table if ummi payment page is open
  const ummiPage = document.getElementById(`page-ummi${lvl}`);
  if (ummiPage?.classList.contains('active')) loadUmmiData(lvl);
}

async function deleteTingkatan(id, lvl) {
  if (!confirm('Hapus tingkatan ini?')) return;
  const { error } = await db.from('ummi_tingkatan').delete().eq('id',id);
  if (error) return toast(error.message,'error');
  toast('Tingkatan dihapus','success');
  const tingkatan = await loadUmmiTingkatan(lvl);
  renderTingkatanGrid(lvl, tingkatan);
  await loadTingkatanAll(); // refresh cache global
  const ummiPage = document.getElementById(`page-ummi${lvl}`);
  if (ummiPage?.classList.contains('active')) loadUmmiData(lvl);
}

// ===================== SQL SETUP =====================
function setSqlSetup() {
  const sql = `-- ============================================
-- APEL JUMBO - Database Setup SQL
-- Jalankan di Supabase SQL Editor
-- Created & Developed by D.D Candra
-- ============================================

CREATE TABLE IF NOT EXISTS kelas (
  id BIGSERIAL PRIMARY KEY,
  nama TEXT NOT NULL,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS mapel (
  id BIGSERIAL PRIMARY KEY,
  nama TEXT NOT NULL,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS siswa (
  id BIGSERIAL PRIMARY KEY,
  nis TEXT,
  nama TEXT NOT NULL,
  kelas_id BIGINT REFERENCES kelas(id),
  jenis_kelamin TEXT,
  bimbingan INTEGER DEFAULT 0,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS jadwal (
  id BIGSERIAL PRIMARY KEY,
  hari TEXT,
  jam_mulai TEXT,
  jam_selesai TEXT,
  kelas_id BIGINT REFERENCES kelas(id),
  mapel_id BIGINT REFERENCES mapel(id),
  ruang TEXT,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS absensi (
  id BIGSERIAL PRIMARY KEY,
  siswa_id BIGINT REFERENCES siswa(id),
  kelas_id BIGINT REFERENCES kelas(id),
  tanggal DATE,
  status TEXT,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS nilai (
  id BIGSERIAL PRIMARY KEY,
  siswa_id BIGINT REFERENCES siswa(id),
  kelas_id BIGINT REFERENCES kelas(id),
  mapel_id BIGINT REFERENCES mapel(id),
  kategori TEXT,
  skor INTEGER DEFAULT 0,
  tanggal DATE,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS jurnal (
  id BIGSERIAL PRIMARY KEY,
  tanggal DATE,
  kelas_id BIGINT REFERENCES kelas(id),
  mapel_id BIGINT REFERENCES mapel(id),
  pertemuan INTEGER DEFAULT 1,
  materi TEXT,
  deskripsi TEXT,
  catatan TEXT,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS bimbingan (
  id BIGSERIAL PRIMARY KEY,
  siswa_id BIGINT REFERENCES siswa(id),
  tanggal DATE,
  kategori TEXT,
  masalah TEXT,
  solusi TEXT,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS integrasi (
  id BIGSERIAL PRIMARY KEY,
  nama TEXT NOT NULL,
  url TEXT NOT NULL,
  ikon TEXT,
  desc TEXT,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS kinerja (
  id BIGSERIAL PRIMARY KEY,
  nama TEXT NOT NULL,
  url TEXT NOT NULL,
  ikon TEXT DEFAULT '',
  deskripsi TEXT,
  logo_base64 TEXT,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS ummi_tingkatan (
  id BIGSERIAL PRIMARY KEY,
  level TEXT NOT NULL,
  nama TEXT NOT NULL,
  urutan INTEGER DEFAULT 1,
  warna TEXT DEFAULT '#1a56db',
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS ummi (
  id BIGSERIAL PRIMARY KEY,
  siswa_id BIGINT REFERENCES siswa(id) ON DELETE CASCADE,
  tingkatan_id BIGINT REFERENCES ummi_tingkatan(id) ON DELETE SET NULL,
  level TEXT NOT NULL,
  tanggal DATE,
  bulan TEXT,
  semester TEXT,
  tahun_pelajaran TEXT,
  status TEXT DEFAULT 'Belum Lunas',
  nominal INTEGER DEFAULT 0,
  catatan TEXT,
  user_id UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- RLS Policies (Enable Row Level Security)
ALTER TABLE kelas ENABLE ROW LEVEL SECURITY;
ALTER TABLE mapel ENABLE ROW LEVEL SECURITY;
ALTER TABLE siswa ENABLE ROW LEVEL SECURITY;
ALTER TABLE jadwal ENABLE ROW LEVEL SECURITY;
ALTER TABLE absensi ENABLE ROW LEVEL SECURITY;
ALTER TABLE nilai ENABLE ROW LEVEL SECURITY;
ALTER TABLE jurnal ENABLE ROW LEVEL SECURITY;
ALTER TABLE bimbingan ENABLE ROW LEVEL SECURITY;
ALTER TABLE integrasi ENABLE ROW LEVEL SECURITY;
ALTER TABLE ummi_tingkatan ENABLE ROW LEVEL SECURITY;
ALTER TABLE ummi ENABLE ROW LEVEL SECURITY;
ALTER TABLE kinerja ENABLE ROW LEVEL SECURITY;

-- Policies: users can only see their own data
DO $$ 
DECLARE t TEXT;
BEGIN
  FOREACH t IN ARRAY ARRAY['kelas','mapel','siswa','jadwal','absensi','nilai','jurnal','bimbingan','integrasi','ummi_tingkatan','ummi','kinerja']
  LOOP
    EXECUTE format('CREATE POLICY IF NOT EXISTS "own_data" ON %I FOR ALL USING (auth.uid() = user_id)', t);
  END LOOP;
END $$;`;
  const el = document.getElementById('sqlSetup');
  if (el) el.value = sql;
}

function copySql() {
  const sql = document.getElementById('sqlSetup').value;
  navigator.clipboard.writeText(sql).then(()=>toast('SQL disalin!', 'success'));
}

// ===================== HELPERS =====================
function setDefaultDates() {
  const today = new Date().toISOString().split('T')[0];
  ['absenDate','bimbinganTgl','jurnalTgl'].forEach(id=>{
    const el = document.getElementById(id);
    if (el) el.value = today;
  });
}

function populateBulan() {
  const bulanNames = ['Januari','Februari','Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember'];
  const currentMonth = new Date().getMonth();
  const opts = bulanNames.map((b,i)=>`<option value="${String(i+1).padStart(2,'0')}" ${i===currentMonth?'selected':''}>${b}</option>`).join('');
  ['rekapAbsenBulan','filterJurnalBulan'].forEach(id=>{
    const el = document.getElementById(id);
    if (el) el.innerHTML = '<option value="">Semua</option>'+opts;
  });
}

function showPage(name) {
  localStorage.setItem('apel_last_page', name);
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  const pg = document.getElementById(`page-${name}`);
  if (pg) pg.classList.add('active');
  // match nav
  const navMap = {
    'dashboard':'Dashboard','siswa':'Data Siswa','jadwal':'Jadwal Mengajar',
    'absensi':'Input Absensi','absenRekap':'Rekap Absensi','nilai':'Input Nilai',
    'nilaiRekap':'Rekap Nilai','jurnal':'Jurnal Mengajar','bimbingan':'Bimbingan Wali',
    'integrasi':'Integrasi ASN','integrasiKinerja':'Integrasi Kinerja','pengaturan':'Pengaturan',
    'ummiTingkatan':'Tingkatan UMMI','ummi7':'Pembayaran UMMI 7','ummi8':'Pembayaran UMMI 8','ummi9':'Pembayaran UMMI 9'
  };
  document.getElementById('pageTitle').textContent = navMap[name] || name;
  // Mark nav active by matching inner text
  document.querySelectorAll('.nav-item').forEach(n=>{
    if(n.textContent.trim().includes(navMap[name])) n.classList.add('active');
  });
  // Close sidebar on mobile
  if (window.innerWidth < 900) {
    document.getElementById('sidebar').classList.remove('open');
    const backdrop = document.getElementById('sidebarBackdrop');
    if (backdrop) backdrop.classList.remove('show');
  }
  
  // Page-specific actions
  if (name==='pengaturan') { applyConfig(); renderKelasTbody(); renderMapelTbody(); setSqlSetup(); }
  if (name==='nilaiRekap') updateRekapMapel();
  if (name==='jurnal') {
    const fjm = document.getElementById('filterJurnalMapel');
    if (fjm) {
      const prev = fjm.value;
      fjm.innerHTML = '<option value="">Semua Mapel</option>' +
        APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('');
      if (prev) fjm.value = prev;
    }
  }
  if (name==='absenRekap') {
    // Populate mapel filter
    const rmp = document.getElementById('rekapAbsenMapel');
    if (rmp) {
      rmp.innerHTML = '<option value="">Semua Mapel</option>' +
        APP_DATA.mapel.map(m=>`<option value="${m.id}">${m.nama}</option>`).join('');
    }
    loadRekapAbsen();
  }
  if (name==='ummiTingkatan') loadAllTingkatan();
  if (name==='integrasiKinerja') renderKinerja();
  if (name==='ummi7') renderUmmiPage('ummi7');
  if (name==='ummi8') renderUmmiPage('ummi8');
  if (name==='ummi9') renderUmmiPage('ummi9');
}

function openModal(id) { document.getElementById(id).classList.add('active'); }
function closeModal(id) { document.getElementById(id).classList.remove('active'); }

function toggleSidebar() {
  const sidebar = document.getElementById('sidebar');
  const backdrop = document.getElementById('sidebarBackdrop');
  sidebar.classList.toggle('open');
  if (backdrop) backdrop.classList.toggle('show');
}

function closeSidebar() {
  document.getElementById('sidebar').classList.remove('open');
  const backdrop = document.getElementById('sidebarBackdrop');
  if (backdrop) backdrop.classList.remove('show');
}

// Close modal on overlay click
document.querySelectorAll('.modal-overlay').forEach(overlay=>{
  overlay.addEventListener('click', e=>{ if(e.target===overlay) overlay.classList.remove('active'); });
});

function toast(msg, type='success') {
  const t = document.getElementById('toast');
  t.textContent = msg; t.className = type;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 3000);
}
</script>
</body>
</html>
